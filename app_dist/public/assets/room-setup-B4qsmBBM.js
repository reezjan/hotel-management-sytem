import{q as we,u as De,v as ke,r as o,j as e,C as c,m as W,n as X,y as Y,a as d,B as i,s as n,I as x}from"./index-Dk6nXF67.js";import{B as Z}from"./badge-P46XOlcm.js";import{T as Ee}from"./textarea-BAi4nzW_.js";import{S as _,a as ee,b as se,c as te,d as oe}from"./select-Gj2YppMn.js";import{D as I,f as P,a as B,b as A,c as $,d as L}from"./dialog-mWSLCdZX.js";import{D as re,r as Oe,a as ie,p as ae,T as ne,e as Fe}from"./dashboard-layout-BUO8e75G.js";import"./index-CC2mel_A.js";import"./index-D-DdYU4C.js";import"./users-Dxbor6Q1.js";import"./circle-alert-BbQxKC8I.js";function Ve(){const{user:l}=we(),{toast:r}=De(),{confirm:q}=ke(),[a,le]=o.useState([]),[m,ce]=o.useState([]),[de,me]=o.useState(!0),[he,j]=o.useState(!1),[h,J]=o.useState(null),[v,N]=o.useState(""),[U,R]=o.useState(""),[pe,f]=o.useState(!1),[ue,C]=o.useState(!1),[p,z]=o.useState(null),[S,T]=o.useState(""),[b,w]=o.useState(""),[D,V]=o.useState(""),[k,H]=o.useState(""),[E,M]=o.useState(""),[O,G]=o.useState(""),xe=[{name:"Standard",description:"Basic comfortable rooms with essential amenities"},{name:"Deluxe",description:"Spacious rooms with premium amenities and city view"},{name:"Suite",description:"Luxury rooms with separate living area and premium services"},{name:"Presidential",description:"Ultimate luxury suites with exclusive amenities and services"},{name:"Executive",description:"Business-class rooms with work facilities and executive lounge access"}];o.useEffect(()=>{l!=null&&l.hotelId&&(y(),g())},[l==null?void 0:l.hotelId]);const y=async()=>{try{const s=await fetch("/api/hotels/current/room-types");if(s.ok){const t=await s.json();le(t)}}catch{}},g=async()=>{try{const s=await fetch("/api/hotels/current/rooms");if(s.ok){const t=await s.json();ce(t)}}catch{}finally{me(!1)}},je=async()=>{try{for(const s of xe)await fetch("/api/room-types",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});r({title:"Success",description:"Default room types created successfully!"}),y()}catch{r({title:"Error",description:"Failed to create default room types",variant:"destructive"})}},fe=async()=>{if(!v.trim()){r({title:"Error",description:"Room type name is required",variant:"destructive"});return}try{const s={name:v,description:U};if((h?await fetch(`/api/room-types/${h.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}):await fetch("/api/room-types",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)r({title:"Success",description:`Room type ${h?"updated":"created"} successfully!`}),y(),K(),j(!1);else throw new Error("Failed to save room type")}catch{r({title:"Error",description:"Failed to save room type",variant:"destructive"})}},ye=async s=>{await q({title:"Delete Room Type",description:"Are you sure you want to delete this room type?",confirmText:"Delete",cancelText:"Cancel",variant:"destructive",onConfirm:async()=>{try{(await fetch(`/api/room-types/${s}`,{method:"DELETE"})).ok&&(r({title:"Success",description:"Room type deleted successfully!"}),y())}catch{r({title:"Error",description:"Failed to delete room type",variant:"destructive"})}}})},ge=async()=>{if(!S.trim()){r({title:"Error",description:"Room number is required",variant:"destructive"});return}try{const s={roomNumber:S,roomTypeId:b?parseInt(b):null};if((p?await fetch(`/api/rooms/${p.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}):await fetch("/api/rooms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)r({title:"Success",description:`Room ${p?"updated":"created"} successfully!`}),g(),Q(),f(!1);else throw new Error("Failed to save room")}catch{r({title:"Error",description:"Failed to save room",variant:"destructive"})}},ve=async()=>{if(!D||!k||!E||!O){r({title:"Error",description:"All fields are required for bulk creation",variant:"destructive"});return}const s=parseInt(E),t=parseInt(O);if(s>t){r({title:"Error",description:"Start number must be less than end number",variant:"destructive"});return}try{const u=[];for(let F=s;F<=t;F++){const be=`${k}${F.toString().padStart(3,"0")}`;u.push(fetch("/api/rooms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomNumber:be,roomTypeId:parseInt(D)})}))}await Promise.all(u),r({title:"Success",description:`${t-s+1} rooms created successfully!`}),g(),Re(),C(!1)}catch{r({title:"Error",description:"Failed to create rooms",variant:"destructive"})}},Ne=async s=>{await q({title:"Delete Room",description:"Are you sure you want to delete this room?",confirmText:"Delete",cancelText:"Cancel",variant:"destructive",onConfirm:async()=>{try{(await fetch(`/api/rooms/${s}`,{method:"DELETE"})).ok&&(r({title:"Success",description:"Room deleted successfully!"}),g())}catch{r({title:"Error",description:"Failed to delete room",variant:"destructive"})}}})},K=()=>{J(null),N(""),R("")},Q=()=>{z(null),T(""),w("")},Re=()=>{V(""),H(""),M(""),G("")},Ce=s=>{J(s),N(s.name),R(s.description||""),j(!0)},Se=s=>{var t;z(s),T(s.roomNumber),w(((t=s.roomTypeId)==null?void 0:t.toString())||""),f(!0)},Te=s=>{const t=a.find(u=>u.id===s);return(t==null?void 0:t.name)||"Unassigned"};return de?e.jsx(re,{title:"Room Setup",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading..."})}):e.jsx(re,{title:"Room Setup",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Room Setup"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage room types and room configurations"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsxs(W,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-5 h-5"}),"Room Types"]}),e.jsx(Y,{children:"Define different categories of rooms (Standard, Deluxe, Suite, etc.)"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{open:he,onOpenChange:j,children:[e.jsx(P,{asChild:!0,children:e.jsxs(i,{onClick:K,className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"Add Room Type"]})}),e.jsxs(B,{children:[e.jsxs(A,{children:[e.jsx($,{children:h?"Edit Room Type":"Create Room Type"}),e.jsx(L,{children:"Add a new category of rooms for your hotel"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"roomTypeName",children:"Name"}),e.jsx(x,{id:"roomTypeName",value:v,onChange:s=>N(s.target.value),placeholder:"e.g., Deluxe, Suite, Presidential"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"roomTypeDescription",children:"Description"}),e.jsx(Ee,{id:"roomTypeDescription",value:U,onChange:s=>R(s.target.value),placeholder:"Describe the features and amenities of this room type",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:fe,children:h?"Update":"Create"}),e.jsx(i,{variant:"outline",onClick:()=>j(!1),children:"Cancel"})]})]})]})]}),a.length===0&&e.jsx(i,{variant:"outline",onClick:je,children:"Create Default Types"})]}),e.jsx("div",{className:"space-y-2",children:a.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No room types found. Create some room types to get started."}):a.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>Ce(s),children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>ye(s.id),className:"text-destructive hover:text-destructive",children:e.jsx(ne,{className:"w-4 h-4"})})]})]},s.id))})]})]}),e.jsxs(c,{children:[e.jsxs(W,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Rooms"]}),e.jsx(Y,{children:"Manage individual rooms and assign them to room types"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{open:pe,onOpenChange:f,children:[e.jsx(P,{asChild:!0,children:e.jsxs(i,{onClick:Q,className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"Add Room"]})}),e.jsxs(B,{children:[e.jsxs(A,{children:[e.jsx($,{children:p?"Edit Room":"Create Room"}),e.jsx(L,{children:"Add a new room to your hotel"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"roomNumber",children:"Room Number"}),e.jsx(x,{id:"roomNumber",value:S,onChange:s=>T(s.target.value),placeholder:"e.g., 101, A-101, Presidential-01"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"roomType",children:"Room Type"}),e.jsxs(_,{value:b,onValueChange:w,children:[e.jsx(ee,{children:e.jsx(se,{placeholder:"Select a room type"})}),e.jsx(te,{children:a.map(s=>e.jsx(oe,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:ge,children:p?"Update":"Create"}),e.jsx(i,{variant:"outline",onClick:()=>f(!1),children:"Cancel"})]})]})]})]}),e.jsxs(I,{open:ue,onOpenChange:C,children:[e.jsx(P,{asChild:!0,children:e.jsx(i,{variant:"outline",disabled:a.length===0,children:"Bulk Create"})}),e.jsxs(B,{children:[e.jsxs(A,{children:[e.jsx($,{children:"Bulk Create Rooms"}),e.jsx(L,{children:"Create multiple rooms with sequential numbering"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"bulkRoomType",children:"Room Type"}),e.jsxs(_,{value:D,onValueChange:V,children:[e.jsx(ee,{children:e.jsx(se,{placeholder:"Select a room type"})}),e.jsx(te,{children:a.map(s=>e.jsx(oe,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"roomPrefix",children:"Room Prefix"}),e.jsx(x,{id:"roomPrefix",value:k,onChange:s=>H(s.target.value),placeholder:"e.g., A, B, FL1, etc."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"startNumber",children:"Start Number"}),e.jsx(x,{id:"startNumber",type:"number",value:E,onChange:s=>M(s.target.value),placeholder:"1"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"endNumber",children:"End Number"}),e.jsx(x,{id:"endNumber",type:"number",value:O,onChange:s=>G(s.target.value),placeholder:"50"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:ve,children:"Create Rooms"}),e.jsx(i,{variant:"outline",onClick:()=>C(!1),children:"Cancel"})]})]})]})]})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:m.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No rooms found. Create some rooms to get started."}):m.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.roomNumber}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{variant:"outline",children:Te(s.roomTypeId)}),s.isOccupied&&e.jsx(Z,{variant:"destructive",children:"Occupied"})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>Se(s),children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>Ne(s.id),className:"text-destructive hover:text-destructive",children:e.jsx(ne,{className:"w-4 h-4"})})]})]},s.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(c,{children:e.jsxs(d,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:a.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Room Types"})]})}),e.jsx(c,{children:e.jsxs(d,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:m.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Rooms"})]})}),e.jsx(c,{children:e.jsxs(d,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:m.filter(s=>s.isOccupied).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Occupied"})]})}),e.jsx(c,{children:e.jsxs(d,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:m.filter(s=>!s.isOccupied).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Available"})]})})]})]})})}export{Ve as default};

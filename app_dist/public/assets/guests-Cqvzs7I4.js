import{r as n,aj as X,a9 as U,az as le,_ as dt,a0 as ct,U as ut,V as mt,j as e,w as $,q as ht,u as xt,v as pt,l as ft,c as jt,d as xe,C as pe,a as fe,m as vt,n as gt,B,I as R,ax as yt,F as Te,e as E,f as N,g as b,h as w,i as I,aA as H,z as Nt,t as bt,k as je,A as ve}from"./index-Dk6nXF67.js";import{A as et,D as wt,i as Ct,aa as St,ab as kt,ac as Et,p as It,T as Dt,ad as $e}from"./dashboard-layout-BUO8e75G.js";import{T as Ge}from"./textarea-BAi4nzW_.js";import{D as Le,a as Be,b as qe,c as Ke}from"./dialog-mWSLCdZX.js";import{S as ze,a as Ue,b as Ve,c as Qe,d as K}from"./select-Gj2YppMn.js";import{C as Ye}from"./calendar-CUmVpCKZ.js";import{P as oe,a as de,b as ce}from"./popover-CrHfQmXJ.js";import{u as At}from"./use-realtime-query-2TJdEol3.js";import{i as Rt}from"./schema-Cuej1IIw.js";import{U as Pt,M as Ft,m as _e,C as He}from"./users-Dxbor6Q1.js";import{f as Je}from"./format-BOBWS5Wu.js";import"./circle-alert-BbQxKC8I.js";import"./index-CC2mel_A.js";import"./index-D-DdYU4C.js";import"./addWeeks-Pc006p7j.js";import"./startOfMonth-CkZi6Jlw.js";import"./use-websocket-ChOW8gRL.js";var We=1,Mt=.9,Ot=.8,Tt=.17,ge=.1,ye=.999,$t=.9999,Gt=.99,Lt=/[\\\/_+.#"@\[\(\{&]/,Bt=/[\\\/_+.#"@\[\(\{&]/g,qt=/[\s-]/,tt=/[\s-]/g;function be(a,l,r,x,i,c,m){if(c===l.length)return i===a.length?We:Gt;var p=`${i},${c}`;if(m[p]!==void 0)return m[p];for(var C=x.charAt(c),d=r.indexOf(C,i),v=0,h,D,P,G;d>=0;)h=be(a,l,r,x,d+1,c+1,m),h>v&&(d===i?h*=We:Lt.test(a.charAt(d-1))?(h*=Ot,P=a.slice(i,d-1).match(Bt),P&&i>0&&(h*=Math.pow(ye,P.length))):qt.test(a.charAt(d-1))?(h*=Mt,G=a.slice(i,d-1).match(tt),G&&i>0&&(h*=Math.pow(ye,G.length))):(h*=Tt,i>0&&(h*=Math.pow(ye,d-i))),a.charAt(d)!==l.charAt(c)&&(h*=$t)),(h<ge&&r.charAt(d-1)===x.charAt(c+1)||x.charAt(c+1)===x.charAt(c)&&r.charAt(d-1)!==x.charAt(c))&&(D=be(a,l,r,x,d+1,c+2,m),D*ge>h&&(h=D*ge)),h>v&&(v=h),d=r.indexOf(C,d+1);return m[p]=v,v}function Xe(a){return a.toLowerCase().replace(tt," ")}function Kt(a,l,r){return a=r&&r.length>0?`${a+" "+r.join(" ")}`:a,be(a,l,Xe(a),Xe(l),0,0,{})}var se='[cmdk-group=""]',Ne='[cmdk-group-items=""]',zt='[cmdk-group-heading=""]',at='[cmdk-item=""]',Ze=`${at}:not([aria-disabled="true"])`,we="cmdk-item-select",J="data-value",Ut=(a,l,r)=>Kt(a,l,r),rt=n.createContext(void 0),ne=()=>n.useContext(rt),st=n.createContext(void 0),Ae=()=>n.useContext(st),lt=n.createContext(void 0),nt=n.forwardRef((a,l)=>{let r=W(()=>{var s,u;return{search:"",value:(u=(s=a.value)!=null?s:a.defaultValue)!=null?u:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),x=W(()=>new Set),i=W(()=>new Map),c=W(()=>new Map),m=W(()=>new Set),p=it(a),{label:C,children:d,value:v,onValueChange:h,filter:D,shouldFilter:P,loop:G,disablePointerSelection:Z=!1,vimBindings:q=!0,...V}=a,ee=X(),f=X(),Q=X(),L=n.useRef(null),k=ta();Y(()=>{if(v!==void 0){let s=v.trim();r.current.value=s,F.emit()}},[v]),Y(()=>{k(6,Re)},[]);let F=n.useMemo(()=>({subscribe:s=>(m.current.add(s),()=>m.current.delete(s)),snapshot:()=>r.current,setState:(s,u,j)=>{var o,g,S,T;if(!Object.is(r.current[s],u)){if(r.current[s]=u,s==="search")y(),t(),k(1,A);else if(s==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let M=document.getElementById(Q);M?M.focus():(o=document.getElementById(ee))==null||o.focus()}if(k(7,()=>{var M;r.current.selectedItemId=(M=_())==null?void 0:M.id,F.emit()}),j||k(5,Re),((g=p.current)==null?void 0:g.value)!==void 0){let M=u??"";(T=(S=p.current).onValueChange)==null||T.call(S,M);return}}F.emit()}},emit:()=>{m.current.forEach(s=>s())}}),[]),te=n.useMemo(()=>({value:(s,u,j)=>{var o;u!==((o=c.current.get(s))==null?void 0:o.value)&&(c.current.set(s,{value:u,keywords:j}),r.current.filtered.items.set(s,ae(u,j)),k(2,()=>{t(),F.emit()}))},item:(s,u)=>(x.current.add(s),u&&(i.current.has(u)?i.current.get(u).add(s):i.current.set(u,new Set([s]))),k(3,()=>{y(),t(),r.current.value||A(),F.emit()}),()=>{c.current.delete(s),x.current.delete(s),r.current.filtered.items.delete(s);let j=_();k(4,()=>{y(),(j==null?void 0:j.getAttribute("id"))===s&&A(),F.emit()})}),group:s=>(i.current.has(s)||i.current.set(s,new Set),()=>{c.current.delete(s),i.current.delete(s)}),filter:()=>p.current.shouldFilter,label:C||a["aria-label"],getDisablePointerSelection:()=>p.current.disablePointerSelection,listId:ee,inputId:Q,labelId:f,listInnerRef:L}),[]);function ae(s,u){var j,o;let g=(o=(j=p.current)==null?void 0:j.filter)!=null?o:Ut;return s?g(s,r.current.search,u):0}function t(){if(!r.current.search||p.current.shouldFilter===!1)return;let s=r.current.filtered.items,u=[];r.current.filtered.groups.forEach(o=>{let g=i.current.get(o),S=0;g.forEach(T=>{let M=s.get(T);S=Math.max(M,S)}),u.push([o,S])});let j=L.current;re().sort((o,g)=>{var S,T;let M=o.getAttribute("id"),ie=g.getAttribute("id");return((S=s.get(ie))!=null?S:0)-((T=s.get(M))!=null?T:0)}).forEach(o=>{let g=o.closest(Ne);g?g.appendChild(o.parentElement===g?o:o.closest(`${Ne} > *`)):j.appendChild(o.parentElement===j?o:o.closest(`${Ne} > *`))}),u.sort((o,g)=>g[1]-o[1]).forEach(o=>{var g;let S=(g=L.current)==null?void 0:g.querySelector(`${se}[${J}="${encodeURIComponent(o[0])}"]`);S==null||S.parentElement.appendChild(S)})}function A(){let s=re().find(j=>j.getAttribute("aria-disabled")!=="true"),u=s==null?void 0:s.getAttribute(J);F.setState("value",u||void 0)}function y(){var s,u,j,o;if(!r.current.search||p.current.shouldFilter===!1){r.current.filtered.count=x.current.size;return}r.current.filtered.groups=new Set;let g=0;for(let S of x.current){let T=(u=(s=c.current.get(S))==null?void 0:s.value)!=null?u:"",M=(o=(j=c.current.get(S))==null?void 0:j.keywords)!=null?o:[],ie=ae(T,M);r.current.filtered.items.set(S,ie),ie>0&&g++}for(let[S,T]of i.current)for(let M of T)if(r.current.filtered.items.get(M)>0){r.current.filtered.groups.add(S);break}r.current.filtered.count=g}function Re(){var s,u,j;let o=_();o&&(((s=o.parentElement)==null?void 0:s.firstChild)===o&&((j=(u=o.closest(se))==null?void 0:u.querySelector(zt))==null||j.scrollIntoView({block:"nearest"})),o.scrollIntoView({block:"nearest"}))}function _(){var s;return(s=L.current)==null?void 0:s.querySelector(`${at}[aria-selected="true"]`)}function re(){var s;return Array.from(((s=L.current)==null?void 0:s.querySelectorAll(Ze))||[])}function me(s){let u=re()[s];u&&F.setState("value",u.getAttribute(J))}function he(s){var u;let j=_(),o=re(),g=o.findIndex(T=>T===j),S=o[g+s];(u=p.current)!=null&&u.loop&&(S=g+s<0?o[o.length-1]:g+s===o.length?o[0]:o[g+s]),S&&F.setState("value",S.getAttribute(J))}function Pe(s){let u=_(),j=u==null?void 0:u.closest(se),o;for(;j&&!o;)j=s>0?Zt(j,se):ea(j,se),o=j==null?void 0:j.querySelector(Ze);o?F.setState("value",o.getAttribute(J)):he(s)}let Fe=()=>me(re().length-1),Me=s=>{s.preventDefault(),s.metaKey?Fe():s.altKey?Pe(1):he(1)},Oe=s=>{s.preventDefault(),s.metaKey?me(0):s.altKey?Pe(-1):he(-1)};return n.createElement(U.div,{ref:l,tabIndex:-1,...V,"cmdk-root":"",onKeyDown:s=>{var u;(u=V.onKeyDown)==null||u.call(V,s);let j=s.nativeEvent.isComposing||s.keyCode===229;if(!(s.defaultPrevented||j))switch(s.key){case"n":case"j":{q&&s.ctrlKey&&Me(s);break}case"ArrowDown":{Me(s);break}case"p":case"k":{q&&s.ctrlKey&&Oe(s);break}case"ArrowUp":{Oe(s);break}case"Home":{s.preventDefault(),me(0);break}case"End":{s.preventDefault(),Fe();break}case"Enter":{s.preventDefault();let o=_();if(o){let g=new Event(we);o.dispatchEvent(g)}}}}},n.createElement("label",{"cmdk-label":"",htmlFor:te.inputId,id:te.labelId,style:ra},C),ue(a,s=>n.createElement(st.Provider,{value:F},n.createElement(rt.Provider,{value:te},s))))}),Vt=n.forwardRef((a,l)=>{var r,x;let i=X(),c=n.useRef(null),m=n.useContext(lt),p=ne(),C=it(a),d=(x=(r=C.current)==null?void 0:r.forceMount)!=null?x:m==null?void 0:m.forceMount;Y(()=>{if(!d)return p.item(i,m==null?void 0:m.id)},[d]);let v=ot(i,c,[a.value,a.children,c],a.keywords),h=Ae(),D=z(k=>k.value&&k.value===v.current),P=z(k=>d||p.filter()===!1?!0:k.search?k.filtered.items.get(i)>0:!0);n.useEffect(()=>{let k=c.current;if(!(!k||a.disabled))return k.addEventListener(we,G),()=>k.removeEventListener(we,G)},[P,a.onSelect,a.disabled]);function G(){var k,F;Z(),(F=(k=C.current).onSelect)==null||F.call(k,v.current)}function Z(){h.setState("value",v.current,!0)}if(!P)return null;let{disabled:q,value:V,onSelect:ee,forceMount:f,keywords:Q,...L}=a;return n.createElement(U.div,{ref:le(c,l),...L,id:i,"cmdk-item":"",role:"option","aria-disabled":!!q,"aria-selected":!!D,"data-disabled":!!q,"data-selected":!!D,onPointerMove:q||p.getDisablePointerSelection()?void 0:Z,onClick:q?void 0:G},a.children)}),Qt=n.forwardRef((a,l)=>{let{heading:r,children:x,forceMount:i,...c}=a,m=X(),p=n.useRef(null),C=n.useRef(null),d=X(),v=ne(),h=z(P=>i||v.filter()===!1?!0:P.search?P.filtered.groups.has(m):!0);Y(()=>v.group(m),[]),ot(m,p,[a.value,a.heading,C]);let D=n.useMemo(()=>({id:m,forceMount:i}),[i]);return n.createElement(U.div,{ref:le(p,l),...c,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},r&&n.createElement("div",{ref:C,"cmdk-group-heading":"","aria-hidden":!0,id:d},r),ue(a,P=>n.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?d:void 0},n.createElement(lt.Provider,{value:D},P))))}),Yt=n.forwardRef((a,l)=>{let{alwaysRender:r,...x}=a,i=n.useRef(null),c=z(m=>!m.search);return!r&&!c?null:n.createElement(U.div,{ref:le(i,l),...x,"cmdk-separator":"",role:"separator"})}),_t=n.forwardRef((a,l)=>{let{onValueChange:r,...x}=a,i=a.value!=null,c=Ae(),m=z(d=>d.search),p=z(d=>d.selectedItemId),C=ne();return n.useEffect(()=>{a.value!=null&&c.setState("search",a.value)},[a.value]),n.createElement(U.input,{ref:l,...x,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":C.listId,"aria-labelledby":C.labelId,"aria-activedescendant":p,id:C.inputId,type:"text",value:i?a.value:m,onChange:d=>{i||c.setState("search",d.target.value),r==null||r(d.target.value)}})}),Ht=n.forwardRef((a,l)=>{let{children:r,label:x="Suggestions",...i}=a,c=n.useRef(null),m=n.useRef(null),p=z(d=>d.selectedItemId),C=ne();return n.useEffect(()=>{if(m.current&&c.current){let d=m.current,v=c.current,h,D=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let P=d.offsetHeight;v.style.setProperty("--cmdk-list-height",P.toFixed(1)+"px")})});return D.observe(d),()=>{cancelAnimationFrame(h),D.unobserve(d)}}},[]),n.createElement(U.div,{ref:le(c,l),...i,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":p,"aria-label":x,id:C.listId},ue(a,d=>n.createElement("div",{ref:le(m,C.listInnerRef),"cmdk-list-sizer":""},d)))}),Jt=n.forwardRef((a,l)=>{let{open:r,onOpenChange:x,overlayClassName:i,contentClassName:c,container:m,...p}=a;return n.createElement(dt,{open:r,onOpenChange:x},n.createElement(ct,{container:m},n.createElement(ut,{"cmdk-overlay":"",className:i}),n.createElement(mt,{"aria-label":a.label,"cmdk-dialog":"",className:c},n.createElement(nt,{ref:l,...p}))))}),Wt=n.forwardRef((a,l)=>z(r=>r.filtered.count===0)?n.createElement(U.div,{ref:l,...a,"cmdk-empty":"",role:"presentation"}):null),Xt=n.forwardRef((a,l)=>{let{progress:r,children:x,label:i="Loading...",...c}=a;return n.createElement(U.div,{ref:l,...c,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},ue(a,m=>n.createElement("div",{"aria-hidden":!0},m)))}),O=Object.assign(nt,{List:Ht,Item:Vt,Input:_t,Group:Qt,Separator:Yt,Dialog:Jt,Empty:Wt,Loading:Xt});function Zt(a,l){let r=a.nextElementSibling;for(;r;){if(r.matches(l))return r;r=r.nextElementSibling}}function ea(a,l){let r=a.previousElementSibling;for(;r;){if(r.matches(l))return r;r=r.previousElementSibling}}function it(a){let l=n.useRef(a);return Y(()=>{l.current=a}),l}var Y=typeof window>"u"?n.useEffect:n.useLayoutEffect;function W(a){let l=n.useRef();return l.current===void 0&&(l.current=a()),l}function z(a){let l=Ae(),r=()=>a(l.snapshot());return n.useSyncExternalStore(l.subscribe,r,r)}function ot(a,l,r,x=[]){let i=n.useRef(),c=ne();return Y(()=>{var m;let p=(()=>{var d;for(let v of r){if(typeof v=="string")return v.trim();if(typeof v=="object"&&"current"in v)return v.current?(d=v.current.textContent)==null?void 0:d.trim():i.current}})(),C=x.map(d=>d.trim());c.value(a,p,C),(m=l.current)==null||m.setAttribute(J,p),i.current=p}),i}var ta=()=>{let[a,l]=n.useState(),r=W(()=>new Map);return Y(()=>{r.current.forEach(x=>x()),r.current=new Map},[a]),(x,i)=>{r.current.set(x,i),l({})}};function aa(a){let l=a.type;return typeof l=="function"?l(a.props):"render"in l?l.render(a.props):a}function ue({asChild:a,children:l},r){return a&&n.isValidElement(l)?n.cloneElement(aa(l),{ref:l.ref},r(l.props.children)):r(l)}var ra={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Ce=n.forwardRef(({className:a,...l},r)=>e.jsx(O,{ref:r,className:$("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...l}));Ce.displayName=O.displayName;const Se=n.forwardRef(({className:a,...l},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(et,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(O.Input,{ref:r,className:$("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...l})]}));Se.displayName=O.Input.displayName;const ke=n.forwardRef(({className:a,...l},r)=>e.jsx(O.List,{ref:r,className:$("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...l}));ke.displayName=O.List.displayName;const Ee=n.forwardRef((a,l)=>e.jsx(O.Empty,{ref:l,className:"py-6 text-center text-sm",...a}));Ee.displayName=O.Empty.displayName;const Ie=n.forwardRef(({className:a,...l},r)=>e.jsx(O.Group,{ref:r,className:$("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...l}));Ie.displayName=O.Group.displayName;const sa=n.forwardRef(({className:a,...l},r)=>e.jsx(O.Separator,{ref:r,className:$("-mx-1 h-px bg-border",a),...l}));sa.displayName=O.Separator.displayName;const De=n.forwardRef(({className:a,...l},r)=>e.jsx(O.Item,{ref:r,className:$("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a),...l}));De.displayName=O.Item.displayName;const la=Rt.extend({dateOfBirth:Nt.date().optional().nullable()});function wa(){const{user:a}=ht(),{toast:l}=xt(),{confirm:r}=pt(),[x,i]=n.useState(!1),[c,m]=n.useState(!1),[p,C]=n.useState(null),[d,v]=n.useState(""),[h,D]=n.useState(),[P,G]=n.useState(!1),[Z,q]=n.useState(!1),{data:V=[],isLoading:ee}=ft({queryKey:["/api/hotels/current/guests"],refetchInterval:3e3,enabled:!!(a!=null&&a.hotelId)});At({queryKey:["/api/hotels/current/guests"],refetchInterval:3e3,events:["guest:created","guest:updated"]});const f=jt({resolver:bt(la),defaultValues:{firstName:"",lastName:"",email:"",phone:"",address:"",city:"",country:"",idType:"",idNumber:"",nationality:"",notes:"",dateOfBirth:null}}),Q=xe({mutationFn:async t=>{const A={...t,hotelId:a==null?void 0:a.hotelId,createdBy:a==null?void 0:a.id,dateOfBirth:h||null};await je("POST","/api/hotels/current/guests",A)},onSuccess:()=>{ve.invalidateQueries({queryKey:["/api/hotels/current/guests"]}),l({title:"Guest added successfully"}),f.reset(),D(void 0),i(!1)},onError:t=>{l({title:"Failed to add guest",description:t.message||"Please try again",variant:"destructive"})}}),L=xe({mutationFn:async t=>{if(!p)return;const A={...t,dateOfBirth:h||null};await je("PUT",`/api/hotels/current/guests/${p.id}`,A)},onSuccess:()=>{ve.invalidateQueries({queryKey:["/api/hotels/current/guests"]}),l({title:"Guest updated successfully"}),f.reset(),D(void 0),C(null),m(!1)},onError:t=>{l({title:"Failed to update guest",description:t.message||"Please try again",variant:"destructive"})}}),k=xe({mutationFn:async t=>{await je("DELETE",`/api/hotels/current/guests/${t}`)},onSuccess:()=>{ve.invalidateQueries({queryKey:["/api/hotels/current/guests"]}),l({title:"Guest deleted successfully"})},onError:()=>{l({title:"Failed to delete guest",variant:"destructive"})}}),F=t=>{C(t),f.reset({firstName:t.firstName,lastName:t.lastName,email:t.email||"",phone:t.phone,address:t.address||"",city:t.city||"",country:t.country||"",idType:t.idType||"",idNumber:t.idNumber||"",nationality:t.nationality||"",notes:t.notes||"",dateOfBirth:t.dateOfBirth?new Date(t.dateOfBirth):null}),t.dateOfBirth&&D(new Date(t.dateOfBirth)),m(!0)},te=async t=>{await r({title:"Delete Guest",description:"Are you sure you want to delete this guest?",confirmText:"Delete",cancelText:"Cancel",variant:"destructive",onConfirm:()=>{k.mutate(t)}})},ae=V.filter(t=>{const A=d.toLowerCase();return t.firstName.toLowerCase().includes(A)||t.lastName.toLowerCase().includes(A)||t.phone.toLowerCase().includes(A)||t.email&&t.email.toLowerCase().includes(A)});return e.jsx(wt,{title:"Guest Management",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(pe,{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white",children:e.jsx(fe,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Total Guests"}),e.jsx("p",{className:"text-4xl font-bold mt-2",children:V.length}),e.jsx("p",{className:"text-sm opacity-90 mt-1",children:"Registered in the system"})]}),e.jsx(Pt,{className:"h-16 w-16 opacity-50"})]})})}),e.jsxs(pe,{children:[e.jsx(vt,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsx(gt,{children:"All Guests"}),e.jsxs(B,{onClick:()=>i(!0),"data-testid":"button-add-guest",children:[e.jsx(Ct,{className:"h-4 w-4 mr-2"}),"Add Guest"]})]})}),e.jsxs(fe,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(et,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(R,{placeholder:"Search guests by name, phone, or email...",value:d,onChange:t=>v(t.target.value),className:"pl-10","data-testid":"input-search-guests"})]})}),ee?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading guests..."}):ae.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:d?"No guests found matching your search":"No guests registered yet"}):e.jsx("div",{className:"grid gap-4",children:ae.map(t=>e.jsx(pe,{className:"hover:shadow-md transition-shadow",children:e.jsx(fe,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 w-full",children:[e.jsxs("h3",{className:"text-lg font-semibold","data-testid":`text-guest-name-${t.id}`,children:[t.firstName," ",t.lastName]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm text-muted-foreground",children:[t.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(St,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:t.phone})]}),t.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kt,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:t.email})]}),t.city&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[t.city,t.country&&`, ${t.country}`]})]}),t.idNumber&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Et,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[t.idType||"ID",": ",t.idNumber]})]})]}),t.notes&&e.jsxs("div",{className:"mt-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Notes:"})," ",t.notes]}),e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Added on ",t.createdAt?yt(t.createdAt):"N/A"]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsx(B,{variant:"outline",size:"sm",onClick:()=>F(t),"data-testid":`button-edit-guest-${t.id}`,className:"flex-1 md:flex-initial",children:e.jsx(It,{className:"h-4 w-4"})}),e.jsx(B,{variant:"outline",size:"sm",onClick:()=>te(t.id),"data-testid":`button-delete-guest-${t.id}`,className:"flex-1 md:flex-initial",children:e.jsx(Dt,{className:"h-4 w-4 text-red-500"})})]})]})})},t.id))})]})]}),e.jsx(Le,{open:x,onOpenChange:i,children:e.jsxs(Be,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(qe,{children:e.jsx(Ke,{children:"Add New Guest"})}),e.jsx(Te,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(t=>Q.mutate(t)),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"firstName",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"First Name *"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"John","data-testid":"input-first-name"})}),e.jsx(I,{})]})}),e.jsx(E,{control:f.control,name:"lastName",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Last Name *"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"Doe","data-testid":"input-last-name"})}),e.jsx(I,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"phone",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Phone *"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"+977-9800000000","data-testid":"input-phone"})}),e.jsx(I,{})]})}),e.jsx(E,{control:f.control,name:"email",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Email"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",type:"email",placeholder:"john@example.com","data-testid":"input-email"})}),e.jsx(I,{})]})})]}),e.jsx(E,{control:f.control,name:"address",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Address"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"Street address","data-testid":"input-address"})}),e.jsx(I,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"city",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"City"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"Kathmandu","data-testid":"input-city"})}),e.jsx(I,{})]})}),e.jsx(E,{control:f.control,name:"country",render:({field:t})=>{var A;return e.jsxs(N,{className:"flex flex-col",children:[e.jsx(b,{children:"Country"}),e.jsxs(oe,{open:P,onOpenChange:G,children:[e.jsx(de,{asChild:!0,children:e.jsx(w,{children:e.jsxs(B,{variant:"outline",role:"combobox",className:$("w-full justify-between",!t.value&&"text-muted-foreground"),"data-testid":"select-country",children:[t.value&&H.find(y=>y.name===t.value)?`${(A=H.find(y=>y.name===t.value))==null?void 0:A.flag} ${t.value}`:"Select country",e.jsx($e,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(ce,{className:"w-full p-0",align:"start",children:e.jsxs(Ce,{children:[e.jsx(Se,{placeholder:"Type to search countries..."}),e.jsxs(ke,{children:[e.jsx(Ee,{children:"No country found."}),e.jsx(Ie,{children:H.map(y=>e.jsxs(De,{value:y.name,onSelect:()=>{t.onChange(y.name),G(!1)},children:[e.jsx(_e,{className:$("mr-2 h-4 w-4",y.name===t.value?"opacity-100":"opacity-0")}),e.jsx("span",{className:"text-lg mr-2",children:y.flag}),y.name]},y.code))})]})]})})]}),e.jsx(I,{})]})}})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"idType",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"ID Type"}),e.jsxs(ze,{onValueChange:t.onChange,value:t.value||void 0,children:[e.jsx(w,{children:e.jsx(Ue,{"data-testid":"select-id-type",children:e.jsx(Ve,{placeholder:"Select ID type"})})}),e.jsxs(Qe,{children:[e.jsx(K,{value:"passport",children:"Passport"}),e.jsx(K,{value:"national_id",children:"National ID"}),e.jsx(K,{value:"driving_license",children:"Driving License"}),e.jsx(K,{value:"citizenship",children:"Citizenship"})]})]}),e.jsx(I,{})]})}),e.jsx(E,{control:f.control,name:"idNumber",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"ID Number"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"ID number","data-testid":"input-id-number"})}),e.jsx(I,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"nationality",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Nationality"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"Nepali","data-testid":"input-nationality"})}),e.jsx(I,{})]})}),e.jsxs(N,{children:[e.jsx(b,{children:"Date of Birth"}),e.jsxs(oe,{children:[e.jsx(de,{asChild:!0,children:e.jsx(w,{children:e.jsxs(B,{variant:"outline",className:$("w-full pl-3 text-left font-normal",!h&&"text-muted-foreground"),"data-testid":"button-select-dob",children:[h?Je(h,"PPP"):e.jsx("span",{children:"Pick a date"}),e.jsx(He,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(ce,{className:"w-auto p-0",align:"start",children:e.jsx(Ye,{mode:"single",selected:h,onSelect:D,disabled:t=>t>new Date,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:1920,toYear:new Date().getFullYear()})})]})]})]}),e.jsx(E,{control:f.control,name:"notes",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Notes"}),e.jsx(w,{children:e.jsx(Ge,{...t,value:t.value||"",placeholder:"Additional notes about the guest",rows:3,"data-testid":"input-notes"})}),e.jsx(I,{})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(B,{type:"submit",className:"flex-1",disabled:Q.isPending,"data-testid":"button-submit-guest",children:Q.isPending?"Adding...":"Add Guest"}),e.jsx(B,{type:"button",variant:"outline",className:"flex-1",onClick:()=>i(!1),children:"Cancel"})]})]})})]})}),e.jsx(Le,{open:c,onOpenChange:m,children:e.jsxs(Be,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(qe,{children:e.jsx(Ke,{children:"Edit Guest"})}),e.jsx(Te,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(t=>L.mutate(t)),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"firstName",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"First Name *"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"John"})}),e.jsx(I,{})]})}),e.jsx(E,{control:f.control,name:"lastName",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Last Name *"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"Doe"})}),e.jsx(I,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"phone",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Phone *"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"+977-9800000000"})}),e.jsx(I,{})]})}),e.jsx(E,{control:f.control,name:"email",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Email"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",type:"email",placeholder:"john@example.com"})}),e.jsx(I,{})]})})]}),e.jsx(E,{control:f.control,name:"address",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Address"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"Street address"})}),e.jsx(I,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"city",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"City"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"Kathmandu"})}),e.jsx(I,{})]})}),e.jsx(E,{control:f.control,name:"country",render:({field:t})=>{var A;return e.jsxs(N,{className:"flex flex-col",children:[e.jsx(b,{children:"Country"}),e.jsxs(oe,{open:Z,onOpenChange:q,children:[e.jsx(de,{asChild:!0,children:e.jsx(w,{children:e.jsxs(B,{variant:"outline",role:"combobox",className:$("w-full justify-between",!t.value&&"text-muted-foreground"),children:[t.value&&H.find(y=>y.name===t.value)?`${(A=H.find(y=>y.name===t.value))==null?void 0:A.flag} ${t.value}`:"Select country",e.jsx($e,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(ce,{className:"w-full p-0",align:"start",children:e.jsxs(Ce,{children:[e.jsx(Se,{placeholder:"Type to search countries..."}),e.jsxs(ke,{children:[e.jsx(Ee,{children:"No country found."}),e.jsx(Ie,{children:H.map(y=>e.jsxs(De,{value:y.name,onSelect:()=>{t.onChange(y.name),q(!1)},children:[e.jsx(_e,{className:$("mr-2 h-4 w-4",y.name===t.value?"opacity-100":"opacity-0")}),e.jsx("span",{className:"text-lg mr-2",children:y.flag}),y.name]},y.code))})]})]})})]}),e.jsx(I,{})]})}})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"idType",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"ID Type"}),e.jsxs(ze,{onValueChange:t.onChange,value:t.value||void 0,children:[e.jsx(w,{children:e.jsx(Ue,{children:e.jsx(Ve,{placeholder:"Select ID type"})})}),e.jsxs(Qe,{children:[e.jsx(K,{value:"passport",children:"Passport"}),e.jsx(K,{value:"national_id",children:"National ID"}),e.jsx(K,{value:"driving_license",children:"Driving License"}),e.jsx(K,{value:"citizenship",children:"Citizenship"})]})]}),e.jsx(I,{})]})}),e.jsx(E,{control:f.control,name:"idNumber",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"ID Number"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"ID number"})}),e.jsx(I,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(E,{control:f.control,name:"nationality",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Nationality"}),e.jsx(w,{children:e.jsx(R,{...t,value:t.value||"",placeholder:"Nepali"})}),e.jsx(I,{})]})}),e.jsxs(N,{children:[e.jsx(b,{children:"Date of Birth"}),e.jsxs(oe,{children:[e.jsx(de,{asChild:!0,children:e.jsx(w,{children:e.jsxs(B,{variant:"outline",className:$("w-full pl-3 text-left font-normal",!h&&"text-muted-foreground"),children:[h?Je(h,"PPP"):e.jsx("span",{children:"Pick a date"}),e.jsx(He,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(ce,{className:"w-auto p-0",align:"start",children:e.jsx(Ye,{mode:"single",selected:h,onSelect:D,disabled:t=>t>new Date,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:1920,toYear:new Date().getFullYear()})})]})]})]}),e.jsx(E,{control:f.control,name:"notes",render:({field:t})=>e.jsxs(N,{children:[e.jsx(b,{children:"Notes"}),e.jsx(w,{children:e.jsx(Ge,{...t,value:t.value||"",placeholder:"Additional notes about the guest",rows:3})}),e.jsx(I,{})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(B,{type:"submit",className:"flex-1",disabled:L.isPending,children:L.isPending?"Updating...":"Update Guest"}),e.jsx(B,{type:"button",variant:"outline",className:"flex-1",onClick:()=>m(!1),children:"Cancel"})]})]})})]})})]})})}export{wa as default};

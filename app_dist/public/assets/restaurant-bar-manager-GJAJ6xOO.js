import{o as Q,l as n,j as e,C as h,m as b,n as p,a as f,B as o}from"./index-Dk6nXF67.js";import{D as H,l as M,c as L,G,H as D}from"./dashboard-layout-BUO8e75G.js";import{S as m}from"./stats-card-DnI6mJO0.js";import{D as u}from"./data-table-BEvwFoVx.js";import{U as x,C as T}from"./users-Dxbor6Q1.js";import"./circle-alert-BbQxKC8I.js";import"./badge-P46XOlcm.js";function Y(){const[,r]=Q(),{data:O=[]}=n({queryKey:["/api/hotels/current/users"],refetchInterval:3e3}),{data:j=[]}=n({queryKey:["/api/hotels/current/menu-items"],refetchInterval:3e3}),{data:y=[]}=n({queryKey:["/api/hotels/current/restaurant-tables"],refetchInterval:3e3}),{data:v=[]}=n({queryKey:["/api/hotels/current/inventory-items"],refetchInterval:3e3}),{data:i=[]}=n({queryKey:["/api/hotels/current/kot-orders"],refetchInterval:3e3}),{data:g=[]}=n({queryKey:["/api/attendance/daily"],refetchInterval:3e3}),l=O.filter(t=>{var a;return["waiter","kitchen_staff","bartender","barista","cashier"].includes(((a=t.role)==null?void 0:a.name)||"")}),N=l.filter(t=>g.some(a=>a.userId===t.id&&a.status==="active")),P=j.filter(t=>t.active),B=v.filter(t=>Number(t.stockQty)<=Number(t.reorderLevel)),K=[{key:"username",label:"Name",sortable:!0},{key:"role",label:"Role",sortable:!0,render:t=>{var a;return(a=t==null?void 0:t.name)==null?void 0:a.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase())}},{key:"id",label:"Status",render:t=>{const a=g.some(s=>s.userId===t&&s.status==="active");return e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs flex items-center space-x-1 ${a?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a?"bg-green-500":"bg-gray-400"}`}),e.jsx("span",{children:a?"On Duty":"Off Duty"})]})}},{key:"lastLogin",label:"Last Active",sortable:!0,render:t=>t?new Date(t).toLocaleString("en-GB",{timeZone:"Asia/Kathmandu"}):"Never"}],_=[{key:"name",label:"Item",sortable:!0},{key:"category",label:"Category",render:(t,a)=>{var s;return((s=a.category)==null?void 0:s.name)||"Uncategorized"}},{key:"price",label:"Price",sortable:!0,render:t=>`रु${t}`},{key:"active",label:"Status",render:t=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t?"Active":"Inactive"})}],R=[{key:"name",label:"Table",sortable:!0},{key:"capacity",label:"Capacity",sortable:!0},{key:"status",label:"Status",render:()=>e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"Available"})}],U=[{key:"name",label:"Item",sortable:!0},{key:"stockQty",label:"Stock",sortable:!0},{key:"unit",label:"Unit",sortable:!0},{key:"status",label:"Status",render:(t,a)=>{const s=Number(a.stockQty),c=Number(a.reorderLevel);return s<=c?e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:"Low Stock"}):s<=c*1.5?e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs",children:"Medium"}):e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"In Stock"})}}],q=[{label:"View",action:()=>r("/restaurant-bar-manager/staff-management")}],z=[{label:"Manage",action:()=>r("/restaurant-bar-manager/menu-management")}],$=[{label:"Manage",action:()=>r("/restaurant-bar-manager/table-setup")}];return e.jsx(H,{title:"Restaurant & Bar Manager Dashboard",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(m,{title:"Staff Members",value:l.length,icon:e.jsx(x,{}),iconColor:"text-blue-500",trend:{value:N.length>0?Math.round(N.length/l.length*100):0,label:"on duty",isPositive:!0}}),e.jsx(m,{title:"Menu Items",value:P.length,icon:e.jsx(M,{}),iconColor:"text-green-500"}),e.jsx(m,{title:"Tables Available",value:y.length,icon:e.jsx(T,{}),iconColor:"text-purple-500"}),e.jsx(m,{title:"Low Stock Alerts",value:B.length,icon:e.jsx(L,{}),iconColor:"text-red-500"})]}),e.jsxs(h,{children:[e.jsx(b,{children:e.jsx(p,{children:"Restaurant Operations"})}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(o,{variant:"outline",className:"h-20 flex flex-col items-center justify-center gap-0.5 p-0 [&_svg]:size-6","data-testid":"button-add-staff",onClick:()=>r("/restaurant-bar-manager/staff-management"),children:[e.jsx(x,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Add Staff"})]}),e.jsxs(o,{variant:"outline",className:"h-20 flex flex-col items-center justify-center gap-0.5 p-0 [&_svg]:size-6","data-testid":"button-menu-management",onClick:()=>r("/restaurant-bar-manager/menu-management"),children:[e.jsx(M,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Menu Management"})]}),e.jsxs(o,{variant:"outline",className:"h-20 flex flex-col items-center justify-center gap-0.5 p-0 [&_svg]:size-6","data-testid":"button-table-setup",onClick:()=>r("/restaurant-bar-manager/table-setup"),children:[e.jsx(T,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Table Setup"})]}),e.jsxs(o,{variant:"outline",className:"h-20 flex flex-col items-center justify-center gap-0.5 p-0 [&_svg]:size-6","data-testid":"button-inventory",onClick:()=>r("/restaurant-bar-manager/inventory-tracking"),children:[e.jsx(L,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Inventory"})]})]})})]}),e.jsx(u,{title:"Restaurant Staff",data:l,columns:K,actions:q,onAdd:()=>r("/restaurant-bar-manager/staff-management"),addButtonLabel:"Add Staff Member",searchPlaceholder:"Search staff..."}),e.jsx(u,{title:"Menu Management",data:j,columns:_,actions:z,onAdd:()=>r("/restaurant-bar-manager/menu-management"),addButtonLabel:"Add Menu Item",searchPlaceholder:"Search menu items..."}),e.jsx(u,{title:"Table Management",data:y,columns:R,actions:$,onAdd:()=>r("/restaurant-bar-manager/table-setup"),addButtonLabel:"Add Table",searchPlaceholder:"Search tables..."}),e.jsx(u,{title:"Inventory Status",data:v,columns:U,searchPlaceholder:"Search inventory items..."}),e.jsxs(h,{children:[e.jsx(b,{children:e.jsx(p,{children:"Today's KOT Summary"})}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg","data-testid":"kot-summary-total",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"Total Orders"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg","data-testid":"kot-summary-completed",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.filter(t=>t.status==="served").length}),e.jsx("div",{className:"text-sm text-green-700",children:"Completed"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg","data-testid":"kot-summary-preparing",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.filter(t=>t.status==="preparing").length}),e.jsx("div",{className:"text-sm text-orange-700",children:"Preparing"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg","data-testid":"kot-summary-revenue",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["रु",i.reduce((t,a)=>a.status==="served"?t+(a.total||0):t,0).toLocaleString()]}),e.jsx("div",{className:"text-sm text-purple-700",children:"Today's Revenue"})]})]})})]}),e.jsxs(h,{children:[e.jsx(b,{children:e.jsx(p,{children:"Staff Performance"})}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:l.slice(0,5).map((t,a)=>{var s,c,k,C,S,w,I;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-secondary rounded-lg","data-testid":`staff-performance-${a}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[((s=t.role)==null?void 0:s.name)==="waiter"&&e.jsx(x,{className:"h-5 w-5 text-blue-500"}),((c=t.role)==null?void 0:c.name)==="kitchen_staff"&&e.jsx(G,{className:"h-5 w-5 text-green-500"}),((k=t.role)==null?void 0:k.name)==="bartender"&&e.jsx(D,{className:"h-5 w-5 text-purple-500"}),((C=t.role)==null?void 0:C.name)==="barista"&&e.jsx(D,{className:"h-5 w-5 text-orange-500"}),((S=t.role)==null?void 0:S.name)==="cashier"&&e.jsx(x,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground",children:t.username}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(I=(w=t.role)==null?void 0:w.name)==null?void 0:I.replace(/_/g," ").replace(/\b\w/g,d=>d.toUpperCase())})]})]}),e.jsx("div",{className:"text-right",children:(()=>{const d=g.some(A=>A.userId===t.id&&A.status==="active");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:d?"On Duty":"Available"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:d?"Currently on duty":"Off duty"})]})})()})]},t.id)})})})]})]})})}export{Y as default};

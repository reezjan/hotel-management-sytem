import{l as p,j as t,p as a,C as m,m as h,n as v,a as y}from"./index-Dk6nXF67.js";import{D as R,b as M}from"./dashboard-layout-BUO8e75G.js";import{S as l}from"./stats-card-DnI6mJO0.js";import{u as j}from"./use-realtime-query-2TJdEol3.js";import{D as _,T as D,R as w}from"./users-Dxbor6Q1.js";import"./circle-alert-BbQxKC8I.js";import"./use-websocket-ChOW8gRL.js";function O(){const{data:n=[]}=p({queryKey:["/api/hotels/current/transactions"],refetchInterval:3e3});p({queryKey:["/api/hotels/current/payments"],refetchInterval:3e3}),j({queryKey:["/api/hotels/current/transactions"],refetchInterval:3e3,events:["transaction:created","transaction:updated"]}),j({queryKey:["/api/hotels/current/payments"],refetchInterval:3e3,events:["payment:created","payment:updated"]});const r=n.filter(e=>e.txnType==="cash_in"||e.txnType==="pos_in"||e.txnType==="fonepay_in"||e.txnType==="revenue"||e.txnType&&e.txnType.includes("_in")),i=r.reduce((e,s)=>e+(Number(s.amount)||0),0),d=n.filter(e=>e.txnType==="cash_out"||e.txnType==="vendor_payment"||e.txnType&&e.txnType.includes("_out")).reduce((e,s)=>e+(Number(s.amount)||0),0),f=r.filter(e=>e.paymentMethod==="cash").reduce((e,s)=>e+(Number(s.amount)||0),0),g=r.filter(e=>e.paymentMethod==="pos").reduce((e,s)=>e+(Number(s.amount)||0),0),N=r.filter(e=>e.paymentMethod==="fonepay").reduce((e,s)=>e+(Number(s.amount)||0),0),T=n.filter(e=>e.paymentMethod==="cash"),b=n.filter(e=>e.paymentMethod==="pos"),C=n.filter(e=>e.paymentMethod==="fonepay");return t.jsx(R,{title:"Financial Overview",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(l,{title:"Total Revenue",value:a(i),icon:t.jsx(_,{}),iconColor:"text-green-500"}),t.jsx(l,{title:"Total Expenses",value:a(d),icon:t.jsx(D,{}),iconColor:"text-red-500"}),t.jsx(l,{title:"Net Profit",value:a(i-d),icon:t.jsx(w,{}),iconColor:"text-blue-500"}),t.jsx(l,{title:"Total Transactions",value:n.length,icon:t.jsx(M,{}),iconColor:"text-purple-500"})]}),t.jsxs(m,{children:[t.jsx(h,{children:t.jsx(v,{children:"Payment Method Breakdown"})}),t.jsx(y,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-lg",children:[t.jsx("div",{className:"text-3xl font-bold text-green-600",children:a(f)}),t.jsx("div",{className:"text-sm text-green-700 mt-2",children:"Cash Revenue"}),t.jsxs("div",{className:"text-xs text-green-600",children:[T.length," total transactions"]})]}),t.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-lg",children:[t.jsx("div",{className:"text-3xl font-bold text-blue-600",children:a(g)}),t.jsx("div",{className:"text-sm text-blue-700 mt-2",children:"POS Revenue"}),t.jsxs("div",{className:"text-xs text-blue-600",children:[b.length," total transactions"]})]}),t.jsxs("div",{className:"text-center p-6 bg-purple-50 rounded-lg",children:[t.jsx("div",{className:"text-3xl font-bold text-purple-600",children:a(N)}),t.jsx("div",{className:"text-sm text-purple-700 mt-2",children:"Fonepay Revenue"}),t.jsxs("div",{className:"text-xs text-purple-600",children:[C.length," total transactions"]})]})]})})]}),t.jsxs(m,{children:[t.jsx(h,{children:t.jsx(v,{children:"Recent Transactions"})}),t.jsx(y,{children:t.jsxs("div",{className:"space-y-4",children:[n.slice(0,10).map((e,s)=>{var o,c,x,u;return t.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:(o=e.txnType)==null?void 0:o.replace(/_/g," ").toUpperCase()}),t.jsx("div",{className:"text-sm text-muted-foreground",children:e.purpose||"No description"}),t.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:`font-bold ${(c=e.txnType)!=null&&c.includes("in")?"text-green-600":"text-red-600"}`,children:[(x=e.txnType)!=null&&x.includes("in")?"+":"-",a(Number(e.amount))]}),t.jsx("div",{className:"text-xs text-muted-foreground",children:(u=e.paymentMethod)==null?void 0:u.toUpperCase()})]})]},e.id||s)}),n.length===0&&t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No transactions found"})]})})]})]})})}export{O as default};

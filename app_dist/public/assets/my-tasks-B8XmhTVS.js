import{q as w,u as C,b as T,l as P,d as D,j as e,C as i,m as l,n as d,a as c,B as o,k as _}from"./index-Dk6nXF67.js";import{D as q,X as I}from"./dashboard-layout-BUO8e75G.js";import{B as m}from"./badge-P46XOlcm.js";import{h,c as M}from"./users-Dxbor6Q1.js";import"./circle-alert-BbQxKC8I.js";function Q(){const{user:x}=w(),{toast:p}=C(),g=T(),{data:j=[]}=P({queryKey:["/api/hotels/current/tasks"],refetchInterval:3e3}),t=D({mutationFn:async({taskId:s,status:a})=>{await _("PUT",`/api/hotels/current/tasks/${s}`,{status:a})},onSuccess:()=>{g.invalidateQueries({queryKey:["/api/hotels/current/tasks"]}),p({title:"Task status updated successfully"})}}),r=j.filter(s=>s.assignedTo===(x==null?void 0:x.id)).sort((s,a)=>{const u={high:0,medium:1,low:2};return u[s.priority]-u[a.priority]}),f=s=>{switch(s){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},y=s=>{switch(s){case"completed":return e.jsx(h,{className:"h-5 w-5 text-green-600"});case"in_progress":return e.jsx(M,{className:"h-5 w-5 text-blue-600"});case"pending_review":return e.jsx(h,{className:"h-5 w-5 text-yellow-600"});case"pending":default:return e.jsx(I,{className:"h-5 w-5 text-gray-400"})}},n=(s,a)=>{t.mutate({taskId:s,status:a})},N=r.filter(s=>s.status==="pending"),b=r.filter(s=>s.status==="in_progress"),v=r.filter(s=>s.status==="completed"||s.status==="pending_review");return e.jsx(q,{title:"My Tasks",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(i,{children:[e.jsx(l,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Pending"})}),e.jsx(c,{children:e.jsx("div",{className:"text-3xl font-bold text-foreground",children:N.length})})]}),e.jsxs(i,{children:[e.jsx(l,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"In Progress"})}),e.jsx(c,{children:e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:b.length})})]}),e.jsxs(i,{children:[e.jsx(l,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Completed"})}),e.jsx(c,{children:e.jsx("div",{className:"text-3xl font-bold text-green-600",children:v.length})})]})]}),e.jsxs(i,{children:[e.jsx(l,{children:e.jsx(d,{children:"All Tasks"})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:r.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No tasks assigned to you"}):r.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 border rounded-lg space-y-3 sm:space-y-0 hover:bg-accent/50 transition-colors",children:[e.jsx("div",{className:"flex-1 space-y-2",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[y(s.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-foreground leading-tight",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsxs(m,{className:f(s.priority),variant:"outline",children:[s.priority.toUpperCase()," PRIORITY"]}),e.jsx(m,{variant:"secondary",children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),s.dueDate&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Due: ",new Date(s.dueDate).toLocaleDateString()]})]})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.status==="pending"&&e.jsx(o,{className:"h-11 min-h-11",onClick:()=>n(s.id,"in_progress"),disabled:t.isPending,children:"Start Task"}),s.status==="in_progress"&&e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"h-11 min-h-11",variant:"outline",onClick:()=>n(s.id,"pending"),disabled:t.isPending,children:"Mark Pending"}),e.jsx(o,{className:"h-11 min-h-11",onClick:()=>n(s.id,"completed"),disabled:t.isPending,children:"Complete"})]}),s.status==="pending_review"&&e.jsx(m,{className:"bg-yellow-100 text-yellow-800 h-11 flex items-center px-4",variant:"secondary",children:"Pending Approval"}),s.status==="completed"&&e.jsx(o,{className:"h-11 min-h-11",variant:"outline",onClick:()=>n(s.id,"pending"),disabled:t.isPending,children:"Reopen"})]})]},s.id))})})]})]})})}export{Q as default};

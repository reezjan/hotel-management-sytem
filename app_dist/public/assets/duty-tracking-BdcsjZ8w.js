import{l as f,j as e,C as d,a as i,m as N,n as b,x as k}from"./index-Dk6nXF67.js";import{D as v,U as D,C as w}from"./dashboard-layout-BUO8e75G.js";import{D as C}from"./data-table-BEvwFoVx.js";import{B as S}from"./badge-P46XOlcm.js";import{U as T,c as I}from"./users-Dxbor6Q1.js";import"./circle-alert-BbQxKC8I.js";function O(){const{data:h=[],isLoading:j}=f({queryKey:["/api/hotels/current/users"],refetchInterval:3e3}),{data:u=[]}=f({queryKey:["/api/attendance/daily"],refetchInterval:3e3}),l=h.filter(s=>{var t;return["waiter","kitchen_staff","bartender","barista","cashier"].includes(((t=s.role)==null?void 0:t.name)||"")}),o=u.filter(s=>s.status==="active").map(s=>s.userId),x=l.filter(s=>o.includes(s.id)),g=l.filter(s=>!o.includes(s.id)),y=s=>u.find(t=>t.userId===s&&t.status==="active"),p=[{key:"username",label:"Staff Name",sortable:!0},{key:"role",label:"Role",sortable:!0,render:s=>{var t;return(t=s==null?void 0:s.name)==null?void 0:t.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())}},{key:"id",label:"Duty Status",render:(s,t)=>{const r=o.includes(t.id),c=y(t.id);return e.jsxs("div",{className:"space-y-1",children:[e.jsx(S,{variant:r?"default":"secondary",className:r?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100",children:r?"On Duty":"Off Duty"}),c&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Since ",k(c.clockInTime)]})]})}},{key:"id",label:"Total Hours Today",render:(s,t)=>{const c=u.filter(n=>n.userId===t.id).reduce((n,m)=>m.totalHours?n+parseFloat(m.totalHours):n,0);return c>0?`${c.toFixed(2)} hrs`:"-"}}],a=(s,t)=>{const r=l.filter(n=>{var m;return((m=n.role)==null?void 0:m.name)===s}),c=r.filter(n=>o.includes(n.id)).length;return t?c:r.length};return e.jsx(v,{title:"Restaurant Duty Tracking",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(d,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Staff"}),e.jsx("p",{className:"text-2xl font-bold",children:l.length})]}),e.jsx(T,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(d,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"On Duty"}),e.jsx("p",{className:"text-2xl font-bold",children:x.length})]}),e.jsx(D,{className:"h-8 w-8 text-green-500"})]})})}),e.jsx(d,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Off Duty"}),e.jsx("p",{className:"text-2xl font-bold",children:g.length})]}),e.jsx(I,{className:"h-8 w-8 text-orange-500"})]})})}),e.jsx(d,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Duty Coverage"}),e.jsxs("p",{className:"text-2xl font-bold",children:[l.length>0?Math.round(x.length/l.length*100):0,"%"]})]}),e.jsx(w,{className:"h-8 w-8 text-purple-500"})]})})})]}),e.jsxs(d,{children:[e.jsx(N,{children:e.jsx(b,{children:"Duty Summary by Role"})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Waiters"}),e.jsxs("span",{className:"font-medium",children:[a("waiter",!0)," / ",a("waiter",!1)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Kitchen Staff"}),e.jsxs("span",{className:"font-medium",children:[a("kitchen_staff",!0)," / ",a("kitchen_staff",!1)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Bartenders"}),e.jsxs("span",{className:"font-medium",children:[a("bartender",!0)," / ",a("bartender",!1)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Baristas"}),e.jsxs("span",{className:"font-medium",children:[a("barista",!0)," / ",a("barista",!1)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Cashiers"}),e.jsxs("span",{className:"font-medium",children:[a("cashier",!0)," / ",a("cashier",!1)]})]})]})})]}),e.jsx(d,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800",children:e.jsx(i,{className:"p-4",children:e.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Note:"})," Staff members manage their own duty status using the duty toggle. Attendance is tracked automatically when staff clock in and out."]})})}),e.jsx(C,{title:"Restaurant Staff Duty Status",data:l,columns:p,isLoading:j,searchPlaceholder:"Search staff..."})]})})}export{O as default};

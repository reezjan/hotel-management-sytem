import{u as N,b as y,l as k,d as v,j as e,C as a,m as i,n as d,a as n,a2 as b,B as m,k as C}from"./index-CuDmVYun.js";import{D as T,I as D,i as S}from"./dashboard-layout-RBv1DXX2.js";import{B as u}from"./badge-DMaRL5Qw.js";import"./users-DXv82DeH.js";import"./circle-alert-CPwmOhkC.js";function M(){const{toast:c}=N(),x=y(),{data:t=[],isLoading:p}=k({queryKey:["/api/tasks/my-tasks"],refetchInterval:3e3}),r=v({mutationFn:async({taskId:s,status:l})=>{await C("PUT",`/api/tasks/${s}`,{status:l})},onSuccess:()=>{x.invalidateQueries({queryKey:["/api/tasks/my-tasks"]}),c({title:"Task updated successfully"})},onError:()=>{c({title:"Error",description:"Failed to update task",variant:"destructive"})}}),h=t.filter(s=>s.status==="pending"),g=t.filter(s=>s.status==="performing"),j=t.filter(s=>s.status==="completed"),o=(s,l)=>{r.mutate({taskId:s.id,status:l})},f=s=>s.status==="pending"?e.jsx(m,{variant:"default",size:"sm",onClick:()=>o(s,"performing"),disabled:r.isPending,"data-testid":`button-start-task-${s.id}`,children:"Start Task"}):s.status==="performing"?e.jsx(m,{variant:"default",size:"sm",onClick:()=>o(s,"completed"),disabled:r.isPending,"data-testid":`button-complete-task-${s.id}`,children:"Mark Complete"}):null;return e.jsx(T,{title:"My Tasks",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(a,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Pending Tasks"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold","data-testid":"count-pending-tasks",children:h.length})})]}),e.jsxs(a,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"In Progress"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold","data-testid":"count-performing-tasks",children:g.length})})]}),e.jsxs(a,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Completed"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold","data-testid":"count-completed-tasks",children:j.length})})]})]}),e.jsxs(a,{children:[e.jsx(i,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"All Tasks"]})}),e.jsx(n,{children:p?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Loading tasks..."}):t.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8","data-testid":"no-tasks-message",children:"No tasks assigned"}):e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-accent transition-colors","data-testid":`task-item-${s.id}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold","data-testid":`task-title-${s.id}`,children:s.title}),e.jsx(u,{variant:b(s.status),"data-testid":`task-status-${s.id}`,children:s.status})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.priority&&e.jsxs("span",{className:"flex items-center gap-1",children:["Priority: ",e.jsx(u,{variant:"outline",children:s.priority})]}),s.dueDate&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(S,{className:"w-3 h-3"}),"Due: ",new Date(s.dueDate).toLocaleDateString()]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:f(s)})]})},s.id))})})]})]})})}export{M as default};

import{q as Oe,u as Ee,b as Be,o as ze,r as f,l as y,c as Re,d as I,j as e,B as l,C as V,m as K,n as L,a as U,F as Ve,e as te,f as ae,g as ne,h as ie,I as re,p as i,k as T}from"./index-CuDmVYun.js";import{D as Ke,i as le,p as Le,L as oe,R as Ue,v as We,F as Qe,s as _e,a as k,a5 as He,C as Ge,G as Ye,a7 as Je}from"./dashboard-layout-RBv1DXX2.js";import{S as W}from"./stats-card-CKM6aMdl.js";import{B as ce}from"./badge-DMaRL5Qw.js";import{T as Xe}from"./textarea-CpuNoaOI.js";import{D as de,a as me,b as ue,c as he}from"./dialog-CYNkLpdV.js";import{S as Ze,a as es,b as ss,c as ts,d as xe}from"./select-7c0Tajxe.js";import{T as as,a as ns,b as pe,c as fe}from"./tabs-CX8s-N0D.js";import{D as is}from"./users-DXv82DeH.js";import{C as rs}from"./circle-alert-CPwmOhkC.js";import"./index-D12ZMnos.js";import"./index-dzpsPapz.js";function ys(){const{user:o}=Oe(),{toast:u}=Ee(),S=Be(),[,Q]=ze(),[v,w]=f.useState([]),[ge,A]=f.useState(!1),[h,P]=f.useState(""),[q,_]=f.useState(""),[d,$]=f.useState(null),[g,je]=f.useState("inhouse"),[ye,F]=f.useState(!1),[b,D]=f.useState([]),{data:x}=y({queryKey:["/api/hotels/current"],refetchInterval:3e3}),{data:ve=[]}=y({queryKey:["/api/hotels/current/menu-items"],refetchInterval:3e3}),{data:H=[]}=y({queryKey:["/api/hotels/current/taxes"],refetchInterval:3e3}),{data:G=[]}=y({queryKey:["/api/halls"],refetchInterval:3e3}),{data:Y=[]}=y({queryKey:["/api/pools"],refetchInterval:3e3}),{data:J=[]}=y({queryKey:["/api/services"],refetchInterval:3e3}),{data:be=[]}=y({queryKey:["/api/users",o==null?void 0:o.id,"tasks"],refetchInterval:3e3}),N=Re({defaultValues:{amount:"",description:""}}),O=I({mutationFn:async s=>{await T("POST","/api/transactions",s)},onSuccess:()=>{S.invalidateQueries({queryKey:["/api/hotels/current/transactions"]}),u({title:"Payment processed successfully"})}}),E=I({mutationFn:async s=>{if(!(o!=null&&o.hotelId))throw new Error("User not associated with a hotel");const t=parseFloat(s.amount);if(isNaN(t)||t<=0)throw new Error("Please enter a valid amount");return await T("POST","/api/transactions",{hotelId:o.hotelId,txnType:"cash_deposit_request",amount:t.toFixed(2),purpose:`Cash Deposit Request: ${s.description}`,reference:`Cashier: ${o.username}`,paymentMethod:"cash",createdBy:o.id})},onSuccess:()=>{u({title:"Success!",description:"Cash deposit request sent to Finance department",variant:"default"}),S.invalidateQueries({queryKey:["/api/hotels/current/transactions"]}),S.invalidateQueries({queryKey:["/api/transactions"]}),F(!1),N.reset()},onError:s=>{u({title:"Error",description:(s==null?void 0:s.message)||"Failed to submit cash deposit request. Please check the amount and try again.",variant:"destructive"})}}),we=I({mutationFn:async({taskId:s,status:t})=>{await T("PUT",`/api/tasks/${s}`,{status:t})},onSuccess:()=>{S.invalidateQueries({queryKey:["/api/users",o==null?void 0:o.id,"tasks"]}),u({title:"Task updated successfully"})}}),B=I({mutationFn:async s=>{if(!s||s.trim().length===0)throw new Error("Please enter a voucher code");return await T("POST","/api/vouchers/validate",{code:s.trim()})},onSuccess:s=>{if(s.valid&&s.voucher){$(s.voucher);const t=s.voucher.discountType==="percentage"?`${s.voucher.discountAmount}% off`:`${i(s.voucher.discountAmount)} off`;u({title:"✓ Voucher Applied!",description:`Code: ${s.voucher.code} - ${t}`,variant:"default"})}else{$(null);const t=s.message||"Voucher code not found or expired";u({title:"Invalid Voucher",description:`${t}. Please check the code and try again. Vouchers must be created by Manager first.`,variant:"destructive"})}},onError:s=>{$(null),u({title:"Validation Error",description:(s==null?void 0:s.message)||"Unable to validate voucher. Please ensure the voucher exists in the system.",variant:"destructive"})}}),C=[...be].sort((s,t)=>{const a={low:0,medium:1,high:2};return a[s.priority]-a[t.priority]}),Ne=C.filter(s=>s.status==="pending"),Ce=C.filter(s=>s.status==="performing"),Te=C.filter(s=>s.status==="completed"),ke=s=>{switch(s){case"high":return"bg-red-100 text-red-800 border-red-300";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"low":return"bg-green-100 text-green-800 border-green-300";default:return"bg-gray-100 text-gray-800"}},Se=s=>{switch(s){case"high":return e.jsx(rs,{className:"h-3 w-3"});case"medium":return e.jsx(le,{className:"h-3 w-3"});case"low":return e.jsx(oe,{className:"h-3 w-3"});default:return null}},Pe=(s,t=0)=>{const a=H.filter(j=>j.isActive);let n=0;a.forEach(j=>{n+=parseFloat(j.percent)/100});const m=Math.round(s/(1+n)*100)/100,c=Math.max(0,Math.round((m-t)*100)/100),p={};let r=0;a.forEach(j=>{const De=parseFloat(j.percent)/100,se=Math.round(c*De*100)/100;p[j.taxType]={rate:parseFloat(j.percent),amount:se},r+=se});const M=Math.round((c+r)*100)/100;return{basePrice:Math.round(m*100)/100,discountedBase:Math.round(c*100)/100,taxBreakdown:p,totalTax:Math.round(r*100)/100,grandTotal:M}},qe=s=>{const t=v.find(a=>a.id===s.id);w(t?a=>a.map(n=>n.id===s.id?{...n,quantity:n.quantity+1}:n):a=>[...a,{...s,quantity:1}])},z=(s,t)=>{const a=g==="inhouse"?s.priceInhouse:s.priceWalkin;b.find(m=>m.id===s.id)||D(m=>[...m,{...s,type:t,price:a,quantity:1}])},X=s=>{w(t=>t.filter(a=>a.id!==s))},$e=s=>{D(t=>t.filter(a=>a.id!==s))},Z=(s,t)=>{if(t<=0){X(s);return}w(a=>a.map(n=>n.id===s?{...n,quantity:t}:n))},Me=()=>{const s=v.reduce((a,n)=>a+n.price*n.quantity,0),t=b.reduce((a,n)=>a+n.price*n.quantity,0);return s+t},R=()=>{const s=Me();let t=0;if(d){const n=parseFloat(d.discountAmount);if(d.discountType==="percentage"){const m=H.filter(r=>r.isActive);let c=0;m.forEach(r=>{c+=parseFloat(r.percent)/100});const p=Math.round(s/(1+c)*100)/100;t=Math.round(p*n/100*100)/100}else t=Math.round(n*100)/100}return{...Pe(s,t),discount:t}},Ie=()=>{q.trim()&&B.mutate(q.trim())},Ae=async()=>{if(!h){u({title:"Error",description:"Please select a payment method",variant:"destructive"});return}const s=R();try{if(await O.mutateAsync({txnType:h==="cash"?"cash_in":h==="pos"?"pos_in":"fonepay_in",amount:s.grandTotal.toString(),paymentMethod:h,purpose:g==="inhouse"?"restaurant_sale":"walk_in_sale",reference:d?`Voucher: ${d.code}`:void 0}),d)try{await T("POST","/api/vouchers/redeem",{voucherId:d.id})}catch{u({title:"Warning",description:"Transaction successful but voucher redemption failed",variant:"destructive"})}Fe()}catch{u({title:"Error",description:"Failed to process payment",variant:"destructive"})}},Fe=()=>{const s=R(),t=(x==null?void 0:x.name)||"HOTEL",a=(x==null?void 0:x.address)||"",n=(x==null?void 0:x.phone)||"",m=new Date;let c=`
<div style="font-family: 'Courier New', monospace; width: 300px; padding: 10px;">
  <div style="text-align: center; font-weight: bold; font-size: 16px; border-bottom: 2px dashed #000; padding-bottom: 10px; margin-bottom: 10px;">
    ${t}
  </div>
  
  <div style="text-align: center; font-size: 11px; margin-bottom: 10px;">
    ${a?`${a}<br/>`:""}
    ${n?`Tel: ${n}<br/>`:""}
  </div>
  
  <div style="text-align: center; font-size: 12px; margin-bottom: 15px;">
    Restaurant Bill<br/>
    ${g==="walkin"?"WALK-IN CUSTOMER":"IN-HOUSE GUEST"}
  </div>
  
  <div style="font-size: 11px; margin-bottom: 10px;">
    <div>Date: ${m.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"2-digit"})}</div>
    <div>Time: ${m.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}</div>
    <div>Bill No: ${m.getTime().toString().slice(-8)}</div>
    <div>Cashier: ${o==null?void 0:o.username}</div>
  </div>
  
  <div style="border-top: 2px dashed #000; border-bottom: 2px dashed #000; padding: 10px 0; margin: 10px 0;">
    <table style="width: 100%; font-size: 11px;">
      <thead>
        <tr style="border-bottom: 1px solid #000;">
          <th style="text-align: left; padding-bottom: 5px;">Item</th>
          <th style="text-align: center; padding-bottom: 5px;">Qty</th>
          <th style="text-align: right; padding-bottom: 5px;">Amount</th>
        </tr>
      </thead>
      <tbody>
`;v.forEach(r=>{c+=`
        <tr>
          <td style="padding: 3px 0;">${r.name}</td>
          <td style="text-align: center;">${r.quantity}</td>
          <td style="text-align: right;">${i(r.price*r.quantity)}</td>
        </tr>`}),b.forEach(r=>{c+=`
        <tr>
          <td style="padding: 3px 0;">${r.name} (${r.type})</td>
          <td style="text-align: center;">${r.quantity}</td>
          <td style="text-align: right;">${i(r.price*r.quantity)}</td>
        </tr>`}),c+=`
      </tbody>
    </table>
  </div>
  
  <div style="font-size: 11px; margin-top: 10px;">
    <div style="display: flex; justify-content: space-between; padding: 3px 0;">
      <span>Subtotal (Excl. Tax):</span>
      <span>${i(s.basePrice)}</span>
    </div>
`,Object.entries(s.taxBreakdown).forEach(([r,M])=>{c+=`
    <div style="display: flex; justify-content: space-between; padding: 3px 0;">
      <span>${r} (${M.rate}%):</span>
      <span>${i(M.amount)}</span>
    </div>`}),s.discount>0&&(c+=`
    <div style="display: flex; justify-content: space-between; padding: 3px 0; color: green;">
      <span>Discount (${d==null?void 0:d.code}):</span>
      <span>- ${i(s.discount)}</span>
    </div>`),c+=`
    <div style="display: flex; justify-content: space-between; padding: 10px 0 5px 0; margin-top: 5px; border-top: 2px dashed #000; font-weight: bold; font-size: 14px;">
      <span>GRAND TOTAL:</span>
      <span>${i(s.grandTotal)}</span>
    </div>
    
    <div style="display: flex; justify-content: space-between; padding: 5px 0; font-weight: bold;">
      <span>Payment Method:</span>
      <span>${h.toUpperCase()}</span>
    </div>
  </div>
  
  <div style="text-align: center; margin-top: 20px; padding-top: 10px; border-top: 2px dashed #000; font-size: 12px;">
    Thank You! Visit Again<br/>
    <div style="margin-top: 5px; font-size: 10px;">
      This is a computer generated bill
    </div>
  </div>
</div>
    `;const p=window.open("","_blank","width=400,height=600");p&&(p.document.write(`
        <html>
          <head>
            <title>Bill - ${t}</title>
            <style>
              @media print {
                body { margin: 0; }
              }
              body {
                margin: 0;
                padding: 20px;
                font-family: 'Courier New', monospace;
              }
            </style>
          </head>
          <body onload="window.print(); window.close();">
            ${c}
          </body>
        </html>
      `),p.document.close()),A(!1),w([]),D([]),P(""),$(null),_("")},ee=(s,t)=>{we.mutate({taskId:s.id,status:t})};return e.jsx(Ke,{title:"Cashier Dashboard",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(W,{title:"Pending Tasks",value:Ne.length,icon:e.jsx(le,{}),iconColor:"text-orange-500"}),e.jsx(W,{title:"In Progress",value:Ce.length,icon:e.jsx(Le,{}),iconColor:"text-blue-500"}),e.jsx(W,{title:"Completed",value:Te.length,icon:e.jsx(oe,{}),iconColor:"text-green-500"}),e.jsxs(l,{className:"h-full min-h-[100px]",onClick:()=>A(!0),size:"lg",children:[e.jsx(Ue,{className:"h-6 w-6 mr-2"}),"New Checkout"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(V,{children:[e.jsx(K,{children:e.jsx(L,{children:"My Tasks (Priority Order)"})}),e.jsx(U,{children:e.jsx("div",{className:"space-y-3",children:C.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No tasks assigned"}):C.map(s=>e.jsxs("div",{className:`flex items-center justify-between p-4 border-2 rounded-lg ${ke(s.priority)}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Se(s.priority),e.jsx("h4",{className:"font-semibold",children:s.title}),e.jsx(ce,{variant:"outline",className:"text-xs",children:s.priority.toUpperCase()})]}),e.jsx("p",{className:"text-sm opacity-90",children:s.description}),e.jsx(ce,{variant:"secondary",className:"text-xs mt-2",children:s.status})]}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[s.status==="pending"&&e.jsx(l,{size:"sm",onClick:()=>ee(s,"performing"),children:"Start"}),s.status==="performing"&&e.jsx(l,{size:"sm",variant:"outline",onClick:()=>ee(s,"completed"),children:"Complete"})]})]},s.id))})})]}),e.jsxs(V,{children:[e.jsx(K,{children:e.jsx(L,{children:"Quick Actions"})}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(l,{variant:"outline",className:"w-full justify-start h-16",onClick:()=>Q("/hall-bookings"),"data-testid":"button-hall-bookings",children:[e.jsx(We,{className:"h-5 w-5 mr-3"}),"View Hall Bookings"]}),e.jsxs(l,{variant:"outline",className:"w-full justify-start h-16",onClick:()=>F(!0),children:[e.jsx(Qe,{className:"h-5 w-5 mr-3"}),"Request Cash Deposit to Finance"]}),e.jsxs(l,{variant:"outline",className:"w-full justify-start h-16",onClick:()=>Q("/cashier/maintenance"),"data-testid":"button-maintenance",children:[e.jsx(_e,{className:"h-5 w-5 mr-3"}),"Report Maintenance Issue"]})]})})]})]}),e.jsx(de,{open:ye,onOpenChange:F,children:e.jsxs(me,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Request Cash Deposit to Finance"})}),e.jsx(Ve,{...N,children:e.jsxs("form",{onSubmit:N.handleSubmit(s=>E.mutate(s)),className:"space-y-4",children:[e.jsx(te,{control:N.control,name:"amount",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:"Amount (NPR)"}),e.jsx(ie,{children:e.jsx(re,{...s,type:"number",step:"0.01",min:"0.01",placeholder:"Enter amount",required:!0})})]})}),e.jsx(te,{control:N.control,name:"description",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:"Description"}),e.jsx(ie,{children:e.jsx(Xe,{...s,placeholder:"Reason for deposit",required:!0})})]})}),e.jsx(l,{type:"submit",className:"w-full",disabled:E.isPending,children:E.isPending?"Submitting...":"Submit Request"})]})})]})}),e.jsx(de,{open:ge,onOpenChange:A,children:e.jsxs(me,{className:"w-full max-w-[95vw] sm:max-w-2xl md:max-w-4xl lg:max-w-6xl max-h-[95vh] overflow-y-auto p-3 sm:p-6",children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-lg sm:text-xl md:text-2xl",children:"Checkout & Billing"})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"w-full",children:e.jsxs(Ze,{value:g,onValueChange:s=>je(s),children:[e.jsx(es,{className:"w-full sm:w-64 h-12 text-base",children:e.jsx(ss,{})}),e.jsxs(ts,{children:[e.jsx(xe,{value:"inhouse",className:"text-base",children:"In-House Guest"}),e.jsx(xe,{value:"walkin",className:"text-base",children:"Walk-In Customer"})]})]})}),e.jsxs(as,{defaultValue:"menu",className:"w-full",children:[e.jsxs(ns,{className:"grid w-full grid-cols-2 h-12",children:[e.jsx(pe,{value:"menu",className:"text-sm sm:text-base",children:"Menu Items"}),e.jsx(pe,{value:"amenities",className:"text-sm sm:text-base",children:"Amenities"})]}),e.jsx(fe,{value:"menu",className:"space-y-2 max-h-[200px] sm:max-h-[300px] overflow-y-auto mt-3",children:ve.filter(s=>s.active).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50 touch-manipulation",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsx("p",{className:"font-medium text-sm sm:text-base truncate",children:s.name}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:i(s.price)})]}),e.jsx(l,{size:"lg",className:"h-10 w-10 sm:h-12 sm:w-12 shrink-0",onClick:()=>qe(s),children:e.jsx(k,{className:"h-5 w-5"})})]},s.id))}),e.jsxs(fe,{value:"amenities",className:"space-y-3 max-h-[200px] sm:max-h-[300px] overflow-y-auto mt-3",children:[G.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Halls"}),G.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg touch-manipulation",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:g==="inhouse"?i(s.priceInhouse):i(s.priceWalkin)})]}),e.jsx(l,{size:"lg",className:"h-10 w-10 sm:h-12 sm:w-12 shrink-0",onClick:()=>z(s,"Hall"),children:e.jsx(k,{className:"h-5 w-5"})})]},s.id))]}),(Y.length>0||J.length>0)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Pools & Services"}),Y.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg touch-manipulation",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:g==="inhouse"?i(s.priceInhouse):i(s.priceWalkin)})]}),e.jsx(l,{size:"lg",className:"h-10 w-10 sm:h-12 sm:w-12 shrink-0",onClick:()=>z(s,"Pool"),children:e.jsx(k,{className:"h-5 w-5"})})]},s.id)),J.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg touch-manipulation",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsxs("p",{className:"font-medium text-sm truncate",children:[s.name," (",s.kind,")"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:g==="inhouse"?i(s.priceInhouse):i(s.priceWalkin)})]}),e.jsx(l,{size:"lg",className:"h-10 w-10 sm:h-12 sm:w-12 shrink-0",onClick:()=>z(s,s.kind),children:e.jsx(k,{className:"h-5 w-5"})})]},s.id))]})]})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("h4",{className:"font-medium mb-2 text-sm sm:text-base",children:"Current Order"}),v.length===0&&b.length===0?e.jsx("p",{className:"text-sm text-muted-foreground py-4 text-center",children:"No items added yet"}):e.jsxs("div",{className:"space-y-2 max-h-[150px] overflow-y-auto",children:[v.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 p-2 bg-muted rounded",children:[e.jsx("span",{className:"flex-1 font-medium text-sm min-w-0 truncate",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 justify-between sm:justify-end",children:[e.jsx(l,{size:"sm",className:"h-8 w-8 sm:h-9 sm:w-9",variant:"outline",onClick:()=>Z(s.id,s.quantity-1),children:e.jsx(He,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),e.jsx("span",{className:"w-6 sm:w-8 text-center text-sm font-semibold",children:s.quantity}),e.jsx(l,{size:"sm",className:"h-8 w-8 sm:h-9 sm:w-9",variant:"outline",onClick:()=>Z(s.id,s.quantity+1),children:e.jsx(k,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),e.jsx("span",{className:"w-16 sm:w-20 text-right text-sm font-semibold",children:i(s.price*s.quantity)}),e.jsx(l,{size:"sm",className:"h-8 w-8 sm:h-9 sm:w-9",variant:"destructive",onClick:()=>X(s.id),children:"×"})]})]},s.id)),b.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 p-2 bg-muted rounded",children:[e.jsxs("span",{className:"flex-1 font-medium text-sm min-w-0 truncate",children:[s.name," (",s.type,")"]}),e.jsxs("div",{className:"flex items-center gap-2 justify-between sm:justify-end",children:[e.jsx("span",{className:"w-8 text-center text-sm font-semibold",children:s.quantity}),e.jsx("span",{className:"w-20 text-right text-sm font-semibold",children:i(s.price*s.quantity)}),e.jsx(l,{size:"sm",className:"h-8 w-8 sm:h-9 sm:w-9",variant:"destructive",onClick:()=>$e(s.id),children:"×"})]})]},s.id))]})]}),e.jsxs(V,{className:"w-full",children:[e.jsx(K,{className:"pb-3",children:e.jsx(L,{className:"text-base sm:text-lg",children:"Bill Summary"})}),e.jsx(U,{className:"space-y-2",children:(()=>{const s=R();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[e.jsx("span",{children:"Subtotal (Excl. Tax):"}),e.jsx("span",{className:"font-semibold",children:i(s.basePrice)})]}),Object.entries(s.taxBreakdown).map(([t,a])=>e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[e.jsxs("span",{children:[t," (",a.rate,"%):"]}),e.jsx("span",{className:"font-semibold",children:i(a.amount)})]},t)),s.discount>0&&e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{className:"font-semibold",children:["- ",i(s.discount)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-base sm:text-lg pt-2 border-t",children:[e.jsx("span",{children:"GRAND TOTAL:"}),e.jsx("span",{children:i(s.grandTotal)})]})]})})()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm sm:text-base",children:"Voucher Code (Optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(re,{placeholder:"Enter voucher code",value:q,onChange:s=>_(s.target.value.toUpperCase()),className:"h-12 text-base"}),e.jsx(l,{onClick:Ie,disabled:B.isPending||!q.trim(),className:"h-12 px-6 shrink-0",children:B.isPending?"...":"Apply"})]}),d&&e.jsxs("p",{className:"text-xs sm:text-sm text-green-600",children:['✓ Voucher "',d.code,'" applied: -',i(d.discountAmount)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm sm:text-base",children:"Payment Method"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsxs(l,{variant:h==="cash"?"default":"outline",className:"h-12 justify-start text-base",onClick:()=>P("cash"),children:[e.jsx(is,{className:"h-5 w-5 mr-2"}),"Cash"]}),e.jsxs(l,{variant:h==="pos"?"default":"outline",className:"h-12 justify-start text-base",onClick:()=>P("pos"),children:[e.jsx(Ge,{className:"h-5 w-5 mr-2"}),"POS/Card"]}),e.jsxs(l,{variant:h==="fonepay"?"default":"outline",className:"h-12 justify-start text-base",onClick:()=>P("fonepay"),children:[e.jsx(Ye,{className:"h-5 w-5 mr-2"}),"Fonepay"]})]})]}),e.jsxs(l,{className:"w-full h-14 text-base sm:text-lg",size:"lg",onClick:Ae,disabled:O.isPending||v.length===0&&b.length===0||!h,children:[e.jsx(Je,{className:"h-5 w-5 mr-2"}),O.isPending?"Processing...":"Checkout & Print Bill"]})]})]})})]})})}export{ys as default};

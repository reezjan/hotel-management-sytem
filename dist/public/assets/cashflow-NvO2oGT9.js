import{q as v,r as w,l as C,j as e,C as n,m as h,n as u,a as x,p as a}from"./index-CuDmVYun.js";import{D as T,b as g,A as F}from"./dashboard-layout-RBv1DXX2.js";import{S as k,a as I,b as S,c as O,d as o}from"./select-7c0Tajxe.js";import{u as M}from"./use-realtime-query-CGmARpos.js";import{T as N,D as f}from"./users-DXv82DeH.js";import"./circle-alert-CPwmOhkC.js";import"./index-D12ZMnos.js";import"./index-dzpsPapz.js";import"./use-websocket-CCUHb1Px.js";function H(){const{user:m}=v(),[b,y]=w.useState("month"),{data:p=[]}=C({queryKey:["/api/hotels/current/transactions"],refetchInterval:3e3,enabled:!!(m!=null&&m.hotelId)});M({queryKey:["/api/hotels/current/transactions"],refetchInterval:3e3,events:["transaction:created","transaction:updated"]});const d=p.filter(s=>{var t;return s.txnType==="cash_in"||s.txnType==="pos_in"||s.txnType==="fonepay_in"||((t=s.txnType)==null?void 0:t.includes("_in"))}),c=p.filter(s=>{var t;return s.txnType==="cash_out"||s.txnType==="vendor_payment"||((t=s.txnType)==null?void 0:t.includes("_out"))}),l=d.reduce((s,t)=>s+Number(t.amount||0),0),i=c.reduce((s,t)=>s+Number(t.amount||0),0),r=l-i,j=i>0?l/i:l>0?1/0:0;return e.jsx(T,{title:"Cash Flow Analysis",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(n,{children:e.jsx(h,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsx(u,{children:"Cash Flow Overview"}),e.jsxs(k,{value:b,onValueChange:y,children:[e.jsx(I,{className:"w-40",children:e.jsx(S,{})}),e.jsxs(O,{children:[e.jsx(o,{value:"today",children:"Today"}),e.jsx(o,{value:"week",children:"This Week"}),e.jsx(o,{value:"month",children:"This Month"}),e.jsx(o,{value:"year",children:"This Year"})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(n,{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white",children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Cash Inflow"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:a(l)}),e.jsxs("p",{className:"text-sm opacity-90 mt-1",children:[d.length," transactions"]})]}),e.jsx(N,{className:"h-12 w-12 opacity-50"})]})})}),e.jsx(n,{className:"bg-gradient-to-r from-red-500 to-pink-600 text-white",children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Cash Outflow"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:a(i)}),e.jsxs("p",{className:"text-sm opacity-90 mt-1",children:[c.length," transactions"]})]}),e.jsx(g,{className:"h-12 w-12 opacity-50"})]})})}),e.jsx(n,{className:`bg-gradient-to-r ${r>=0?"from-blue-500 to-cyan-600":"from-orange-500 to-red-600"} text-white`,children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Net Cash Flow"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:a(r)}),e.jsx("p",{className:"text-sm opacity-90 mt-1",children:r>=0?"Positive":"Negative"})]}),e.jsx(f,{className:"h-12 w-12 opacity-50"})]})})}),e.jsx(n,{className:"bg-gradient-to-r from-purple-500 to-indigo-600 text-white",children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Cash Flow Ratio"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:j===1/0?"âˆž":j.toFixed(2)}),e.jsx("p",{className:"text-sm opacity-90 mt-1",children:"Inflow/Outflow"})]}),e.jsx(F,{className:"h-12 w-12 opacity-50"})]})})})]}),e.jsxs(n,{children:[e.jsx(h,{children:e.jsx(u,{children:"Cash Flow Breakdown"})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-6 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Cash Inflow"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Revenue from all sources"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:a(l)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[d.length," transactions"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"text-center p-3 bg-white dark:bg-gray-800 rounded",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cash"}),e.jsx("p",{className:"font-bold text-green-600",children:a(d.filter(s=>s.paymentMethod==="cash").reduce((s,t)=>s+Number(t.amount),0))})]}),e.jsxs("div",{className:"text-center p-3 bg-white dark:bg-gray-800 rounded",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"POS"}),e.jsx("p",{className:"font-bold text-green-600",children:a(d.filter(s=>s.paymentMethod==="pos").reduce((s,t)=>s+Number(t.amount),0))})]}),e.jsxs("div",{className:"text-center p-3 bg-white dark:bg-gray-800 rounded",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fonepay"}),e.jsx("p",{className:"font-bold text-green-600",children:a(d.filter(s=>s.paymentMethod==="fonepay").reduce((s,t)=>s+Number(t.amount),0))})]})]})]}),e.jsxs("div",{className:"p-6 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Cash Outflow"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Expenses and payments"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:a(i)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c.length," transactions"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"text-center p-3 bg-white dark:bg-gray-800 rounded",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cash"}),e.jsx("p",{className:"font-bold text-red-600",children:a(c.filter(s=>s.paymentMethod==="cash").reduce((s,t)=>s+Number(t.amount),0))})]}),e.jsxs("div",{className:"text-center p-3 bg-white dark:bg-gray-800 rounded",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"POS"}),e.jsx("p",{className:"font-bold text-red-600",children:a(c.filter(s=>s.paymentMethod==="pos").reduce((s,t)=>s+Number(t.amount),0))})]}),e.jsxs("div",{className:"text-center p-3 bg-white dark:bg-gray-800 rounded",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fonepay"}),e.jsx("p",{className:"font-bold text-red-600",children:a(c.filter(s=>s.paymentMethod==="fonepay").reduce((s,t)=>s+Number(t.amount),0))})]})]})]}),e.jsx("div",{className:`p-6 ${r>=0?"bg-blue-50 dark:bg-blue-900/20":"bg-orange-50 dark:bg-orange-900/20"} rounded-lg`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:`h-8 w-8 ${r>=0?"text-blue-600":"text-orange-600"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Net Cash Flow"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Inflow minus outflow"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-2xl font-bold ${r>=0?"text-blue-600":"text-orange-600"}`,children:a(r)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r>=0?"Surplus":"Deficit"})]})]})})]})})]}),e.jsxs(n,{children:[e.jsx(h,{children:e.jsx(u,{children:"Cash Flow Health Indicators"})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-6 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Operating Cash Flow"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:a(r)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Current period"})]}),e.jsxs("div",{className:"text-center p-6 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Cash Conversion Rate"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:[l>0?(r/l*100).toFixed(1):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Efficiency metric"})]}),e.jsxs("div",{className:"text-center p-6 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Burn Rate"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:a(i/30)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Per day average"})]})]})})]})]})})}export{H as default};

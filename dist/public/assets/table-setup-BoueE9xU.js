import{v as R,r as j,b as V,l as K,d as b,j as e,C as o,a as u,s as x,I as p,B as f}from"./index-CuDmVYun.js";import{D as M,a1 as U,Q as $}from"./dashboard-layout-RBv1DXX2.js";import{D as B}from"./data-table-B69p7Klv.js";import{S as g,a as y,b as v,c as N,d as l}from"./select-7c0Tajxe.js";import{D as J,a as G,b as H,c as z}from"./dialog-CYNkLpdV.js";import{t as r}from"./index-hq1wgpuD.js";import{U as T}from"./users-DXv82DeH.js";import"./circle-alert-CPwmOhkC.js";import"./badge-DMaRL5Qw.js";import"./index-D12ZMnos.js";import"./index-dzpsPapz.js";function ne(){const{confirm:C}=R(),[w,d]=j.useState(!1),[t,i]=j.useState({name:"",capacity:"",location:"",status:"available"}),m=V(),{data:c=[],isLoading:S}=K({queryKey:["/api/hotels/current/restaurant-tables"],refetchInterval:3e3}),h=b({mutationFn:async a=>{const s=await fetch("/api/hotels/current/restaurant-tables",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...a,capacity:parseInt(a.capacity)})});if(!s.ok){const n=await s.json();throw new Error(n.message||"Failed to create table")}return s.json()},onSuccess:()=>{m.invalidateQueries({queryKey:["/api/hotels/current/restaurant-tables"]}),d(!1),i({name:"",capacity:"",location:"",status:"available"}),r.success("Table created successfully")},onError:a=>{r.error(a.message)}}),D=b({mutationFn:async({tableId:a,status:s})=>{const n=await fetch(`/api/hotels/current/restaurant-tables/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({status:s})});if(!n.ok)throw new Error("Failed to update table");return n.json()},onSuccess:()=>{m.invalidateQueries({queryKey:["/api/hotels/current/restaurant-tables"]}),r.success("Table status updated")},onError:a=>{r.error(a.message)}}),A=()=>{if(!t.name||!t.capacity){r.error("Please fill in table name and capacity");return}h.mutate(t)},E=(a,s)=>{D.mutate({tableId:a.id,status:s})},I=async a=>{await C({title:"Delete Table",description:`Are you sure you want to delete table "${a.name}"?`,confirmText:"Delete",cancelText:"Cancel",variant:"destructive",onConfirm:async()=>{try{if(!(await fetch(`/api/hotels/current/restaurant-tables/${a.id}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to delete table");m.invalidateQueries({queryKey:["/api/hotels/current/restaurant-tables"]}),r.success("Table deleted successfully")}catch(s){r.error(s.message)}}})},P=a=>{switch(a){case"available":return"text-green-600 bg-green-100";case"occupied":return"text-red-600 bg-red-100";case"reserved":return"text-orange-600 bg-orange-100";case"cleaning":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},k=[{key:"name",label:"Table Name",sortable:!0},{key:"capacity",label:"Capacity",sortable:!0,render:a=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(T,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{children:[a," guests"]})]})},{key:"location",label:"Location",render:a=>a?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx($,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:a})]}):"Not specified"},{key:"status",label:"Status",render:(a,s)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(a)}`,children:(a==null?void 0:a.charAt(0).toUpperCase())+(a==null?void 0:a.slice(1))}),e.jsxs(g,{value:a,onValueChange:n=>E(s,n),children:[e.jsx(y,{className:"w-28 h-8",children:e.jsx(v,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"available",children:"Available"}),e.jsx(l,{value:"occupied",children:"Occupied"}),e.jsx(l,{value:"reserved",children:"Reserved"}),e.jsx(l,{value:"cleaning",children:"Cleaning"})]})]})]})}],F=[{label:"Delete",action:I,variant:"destructive"}],O=c.length,L=c.filter(a=>a.status==="available").length,Q=c.filter(a=>a.status==="occupied").length,q=c.reduce((a,s)=>a+(s.capacity||0),0);return e.jsx(M,{title:"Table Setup",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(o,{children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Tables"}),e.jsx("p",{className:"text-2xl font-bold",children:O})]}),e.jsx(U,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(o,{children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Available"}),e.jsx("p",{className:"text-2xl font-bold",children:L})]}),e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("div",{className:"h-4 w-4 rounded-full bg-green-500"})})]})})}),e.jsx(o,{children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Occupied"}),e.jsx("p",{className:"text-2xl font-bold",children:Q})]}),e.jsx("div",{className:"h-8 w-8 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("div",{className:"h-4 w-4 rounded-full bg-red-500"})})]})})}),e.jsx(o,{children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Capacity"}),e.jsx("p",{className:"text-2xl font-bold",children:q})]}),e.jsx(T,{className:"h-8 w-8 text-purple-500"})]})})})]}),e.jsx(B,{title:"Restaurant Tables",data:c,columns:k,actions:F,isLoading:S,onAdd:()=>d(!0),addButtonLabel:"Add Table",searchPlaceholder:"Search tables..."}),e.jsx(J,{open:w,onOpenChange:d,children:e.jsxs(G,{className:"max-w-md",children:[e.jsx(H,{children:e.jsx(z,{children:"Add Restaurant Table"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"name",children:"Table Name *"}),e.jsx(p,{id:"name",value:t.name,onChange:a=>i({...t,name:a.target.value}),placeholder:"e.g., Table 1, VIP A, Patio 3"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"capacity",children:"Capacity (Number of Guests) *"}),e.jsx(p,{id:"capacity",type:"number",min:"1",value:t.capacity,onChange:a=>i({...t,capacity:a.target.value}),placeholder:"Enter number of seats"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"location",children:"Location/Area"}),e.jsx(p,{id:"location",value:t.location,onChange:a=>i({...t,location:a.target.value}),placeholder:"e.g., Indoor, Patio, VIP Section"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"status",children:"Initial Status"}),e.jsxs(g,{value:t.status,onValueChange:a=>i({...t,status:a}),children:[e.jsx(y,{children:e.jsx(v,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"available",children:"Available"}),e.jsx(l,{value:"cleaning",children:"Cleaning"}),e.jsx(l,{value:"reserved",children:"Reserved"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(f,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(f,{onClick:A,disabled:h.isPending,children:h.isPending?"Creating...":"Create Table"})]})]})]})})]})})}export{ne as default};

import{r as u,j as e,C as A,w as y,m as O,n as _,I as z,B as b,a as I,a2 as R}from"./index-CuDmVYun.js";import{B as U}from"./badge-DMaRL5Qw.js";import{M as H,l as J}from"./dashboard-layout-RBv1DXX2.js";function P({title:p,data:S,columns:i,searchPlaceholder:C="Search...",actions:c=[],onAdd:j,addButtonLabel:v="Add New",className:k,isLoading:$=!1}){const[g,D]=u.useState(""),[o,L]=u.useState(null),[x,N]=u.useState("asc"),E=()=>{if(m.length===0)return;const t=i.map(h=>h.label).join(","),a=m.map(h=>i.map(f=>{let r=h[f.key];if(f.render){const n=f.render(r,h);typeof n=="object"&&n!==null?"props"in n&&n.props&&"children"in n.props?r=String(n.props.children):r=String(r||""):r=String(n||"")}else typeof r=="object"&&r!==null?r.name?r=r.name:r.label?r=r.label:r=JSON.stringify(r):r=String(r||"");return`"${String(r).replace(/"/g,'""')}"`}).join(",")),s=[t,...a].join(`
`),l=new Blob([s],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),T=URL.createObjectURL(l);d.setAttribute("href",T),d.setAttribute("download",`${p.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)},w=S.filter(t=>Object.values(t).some(a=>String(a).toLowerCase().includes(g.toLowerCase()))),m=o?[...w].sort((t,a)=>{const s=t[o],l=a[o];return s<l?x==="asc"?-1:1:s>l?x==="asc"?1:-1:0}):w,V=t=>{o===t?N(x==="asc"?"desc":"asc"):(L(t),N("asc"))},B=(t,a,s)=>t.render?t.render(a,s):t.key.includes("status")?e.jsx(U,{className:R(a),variant:"secondary",children:a}):t.key.includes("date")||t.key.includes("time")?new Date(a).toLocaleDateString():t.key.includes("amount")||t.key.includes("price")?`रु${Number(a).toLocaleString()}`:a;return e.jsxs(A,{className:y("",k),"data-testid":`table-${p.toLowerCase().replace(/\s+/g,"-")}`,children:[e.jsx(O,{className:"p-4 md:p-6",children:e.jsxs("div",{className:"space-y-3 md:space-y-0 md:flex md:items-center md:justify-between",children:[e.jsx(_,{className:"text-base md:text-lg","data-testid":`table-title-${p.toLowerCase().replace(/\s+/g,"-")}`,children:p}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1 sm:flex-initial",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(z,{placeholder:C,value:g,onChange:t=>D(t.target.value),className:"pl-9 w-full sm:w-48 md:w-64","data-testid":"input-search"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm","data-testid":"button-export",onClick:E,disabled:m.length===0,title:"Export to CSV",className:"flex-1 sm:flex-initial",children:[e.jsx(J,{className:"h-4 w-4 mr-0 sm:mr-2"}),e.jsx("span",{className:"sm:inline",children:"Export"})]}),j&&e.jsx(b,{onClick:j,size:"sm","data-testid":"button-add",className:"flex-1 sm:flex-initial",children:v})]})]})]})}),e.jsx(I,{className:"p-0 md:p-6 md:pt-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[i.map(t=>e.jsx("th",{className:y("text-left p-3 md:p-4 text-foreground font-medium text-xs md:text-sm whitespace-nowrap",t.sortable&&"cursor-pointer hover:bg-muted"),onClick:()=>t.sortable&&V(t.key),"data-testid":`table-header-${t.key}`,children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.label}),t.sortable&&o===t.key&&e.jsx("span",{className:"text-xs",children:x==="asc"?"↑":"↓"})]})},t.key)),c.length>0&&e.jsx("th",{className:"text-left p-3 md:p-4 text-foreground font-medium text-xs md:text-sm whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:$?Array.from({length:3}).map((t,a)=>e.jsxs("tr",{className:"border-b border-border",children:[i.map(s=>e.jsx("td",{className:"p-3 md:p-4",children:e.jsx("div",{className:"h-4 bg-muted animate-pulse rounded w-3/4"})},s.key)),c.length>0&&e.jsx("td",{className:"p-3 md:p-4",children:e.jsx("div",{className:"flex space-x-2",children:c.map((s,l)=>e.jsx("div",{className:"h-8 w-16 bg-muted animate-pulse rounded"},l))})})]},`loading-${a}`)):m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:i.length+(c.length>0?1:0),className:"text-center p-6 md:p-8 text-muted-foreground text-sm","data-testid":"table-empty-state",children:"No data found"})}):m.map((t,a)=>e.jsxs("tr",{className:"border-b border-border hover:bg-muted/50","data-testid":`table-row-${a}`,children:[i.map(s=>e.jsx("td",{className:"p-3 md:p-4 text-xs md:text-sm","data-testid":`table-cell-${s.key}-${a}`,children:B(s,t[s.key],t)},s.key)),c.length>0&&e.jsx("td",{className:"p-3 md:p-4",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:c.map((s,l)=>(s.show?s.show(t):!0)?e.jsx(b,{variant:s.variant||"outline",size:"sm",onClick:()=>s.action(t),"data-testid":`table-action-${s.label.toLowerCase().replace(/\s+/g,"-")}-${a}`,className:"text-xs whitespace-nowrap",children:s.label},l):null)})})]},t.id||a))})]})})})]})}export{P as D};

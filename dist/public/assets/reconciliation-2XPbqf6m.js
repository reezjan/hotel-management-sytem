import{q as R,r as T,l as P,j as e,C as l,m as c,n as r,B as I,a as d,p as a,av as O}from"./index-CuDmVYun.js";import{D as B,o as i,C as D,G as _}from"./dashboard-layout-RBv1DXX2.js";import{S as k,a as F,b as M,c as q,d as x}from"./select-7c0Tajxe.js";import{u as A}from"./use-realtime-query-CGmARpos.js";import{D as $}from"./users-DXv82DeH.js";import"./circle-alert-CPwmOhkC.js";import"./index-D12ZMnos.js";import"./index-dzpsPapz.js";import"./use-websocket-CCUHb1Px.js";function U(){const{user:m}=R(),[S,C]=T.useState("pending"),{data:n=[]}=P({queryKey:["/api/hotels/current/transactions"],refetchInterval:3e3,enabled:!!(m!=null&&m.hotelId)});A({queryKey:["/api/hotels/current/transactions"],refetchInterval:3e3,events:["transaction:created","transaction:updated"]});const o=n.filter(s=>s.paymentMethod==="cash"),h=n.filter(s=>s.paymentMethod==="pos"),p=n.filter(s=>s.paymentMethod==="fonepay"),u=o.filter(s=>{var t;return(t=s.txnType)==null?void 0:t.includes("_in")}).reduce((s,t)=>s+Number(t.amount||0),0),j=o.filter(s=>{var t;return((t=s.txnType)==null?void 0:t.includes("_out"))||s.txnType==="vendor_payment"}).reduce((s,t)=>s+Number(t.amount||0),0),f=u-j,N=h.filter(s=>{var t;return(t=s.txnType)==null?void 0:t.includes("_in")}).reduce((s,t)=>s+Number(t.amount||0),0),g=h.filter(s=>{var t;return((t=s.txnType)==null?void 0:t.includes("_out"))||s.txnType==="vendor_payment"}).reduce((s,t)=>s+Number(t.amount||0),0),y=N-g,b=p.filter(s=>{var t;return(t=s.txnType)==null?void 0:t.includes("_in")}).reduce((s,t)=>s+Number(t.amount||0),0),v=p.filter(s=>{var t;return((t=s.txnType)==null?void 0:t.includes("_out"))||s.txnType==="vendor_payment"}).reduce((s,t)=>s+Number(t.amount||0),0),w=b-v;return e.jsx(B,{title:"Payment Reconciliation",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(l,{children:e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsx(r,{children:"Payment Reconciliation Dashboard"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(k,{value:S,onValueChange:C,children:[e.jsx(F,{className:"w-40",children:e.jsx(M,{})}),e.jsxs(q,{children:[e.jsx(x,{value:"all",children:"All Status"}),e.jsx(x,{value:"pending",children:"Pending"}),e.jsx(x,{value:"reconciled",children:"Reconciled"}),e.jsx(x,{value:"discrepancy",children:"Discrepancy"})]})]}),e.jsx(I,{children:"Generate Report"})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5 text-green-500"}),"Cash Reconciliation"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Cash In:"}),e.jsx("span",{className:"font-semibold text-green-600",children:a(u)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Cash Out:"}),e.jsx("span",{className:"font-semibold text-red-600",children:a(j)})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Cash Balance:"}),e.jsx("span",{className:`font-bold text-lg ${f>=0?"text-green-600":"text-red-600"}`,children:a(f)})]})})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"Reconciled"})]})]})]})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-blue-500"}),"POS Reconciliation"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"POS In:"}),e.jsx("span",{className:"font-semibold text-green-600",children:a(N)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"POS Out:"}),e.jsx("span",{className:"font-semibold text-red-600",children:a(g)})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"POS Balance:"}),e.jsx("span",{className:`font-bold text-lg ${y>=0?"text-green-600":"text-red-600"}`,children:a(y)})]})})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"Reconciled"})]})]})]})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5 text-purple-500"}),"Fonepay Reconciliation"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Fonepay In:"}),e.jsx("span",{className:"font-semibold text-green-600",children:a(b)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Fonepay Out:"}),e.jsx("span",{className:"font-semibold text-red-600",children:a(v)})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Fonepay Balance:"}),e.jsx("span",{className:`font-bold text-lg ${w>=0?"text-green-600":"text-red-600"}`,children:a(w)})]})})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"Reconciled"})]})]})]})]})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsx(r,{children:"Recent Transactions Requiring Reconciliation"})}),e.jsx(d,{children:e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Payment Method"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Status"})]})}),e.jsx("tbody",{children:n.slice(0,10).map(s=>e.jsxs("tr",{className:"border-t hover:bg-muted/50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:O(s.createdAt)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.txnType}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:a(Number(s.amount))}),e.jsx("td",{className:"px-4 py-3 text-sm capitalize",children:s.paymentMethod}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",children:[e.jsx(i,{className:"h-3 w-3"}),"Reconciled"]})})]},s.id))})]})})})})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsx(r,{children:"Reconciliation Summary"})}),e.jsx(d,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.length}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Total Transactions"})]}),e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n.length}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Reconciled"})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:"0"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Pending"})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:"0"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Discrepancies"})]})]})})]})]})})}export{U as default};

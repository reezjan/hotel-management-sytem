import{o as C,l as d,j as e,C as N,m as S,n as A,a as D,B as i}from"./index-CuDmVYun.js";import{D as T,i as m,I as f,J as w,h as I,s as L}from"./dashboard-layout-RBv1DXX2.js";import{S as l}from"./stats-card-CKM6aMdl.js";import{D as p}from"./data-table-B69p7Klv.js";import{U as B}from"./users-DXv82DeH.js";import"./circle-alert-CPwmOhkC.js";import"./badge-DMaRL5Qw.js";function U(){const[,a]=C(),{data:u=[]}=d({queryKey:["/api/hotels/current/users"],refetchInterval:5e3,refetchIntervalInBackground:!0}),{data:o=[]}=d({queryKey:["/api/hotels/current/tasks"],refetchInterval:5e3,refetchIntervalInBackground:!0}),{data:g=[]}=d({queryKey:["/api/attendance/daily"]}),r=u.filter(s=>{var t;return((t=s.role)==null?void 0:t.name)==="housekeeping_staff"}),c=r.filter(s=>g.some(t=>t.userId===s.id&&t.status==="active")),h=o.filter(s=>s.status==="pending"),x=o.filter(s=>s.status==="completed"),k=[{key:"username",label:"Name",sortable:!0},{key:"id",label:"Duty Status",render:s=>{const t=g.some(n=>n.userId===s&&n.status==="active");return e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs flex items-center space-x-1 ${t?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t?"bg-green-500":"bg-gray-400"}`}),e.jsx("span",{children:t?"On Duty":"Off Duty"})]})}},{key:"lastLogin",label:"Last Active",sortable:!0,render:s=>s?new Date(s).toLocaleString("en-GB",{timeZone:"Asia/Kathmandu"}):"Never"},{key:"createdAt",label:"Joined",sortable:!0}],j=[{key:"title",label:"Task",sortable:!0},{key:"assignedTo",label:"Assigned To",render:(s,t)=>{const n=u.find(b=>b.id===t.assignedTo);return(n==null?void 0:n.username)||"Unassigned"}},{key:"status",label:"Status",sortable:!0},{key:"createdAt",label:"Created",sortable:!0}],v=[{label:"Assign Task",action:s=>{}},{label:"Remove",action:s=>{},variant:"destructive"}],y=[{label:"Edit",action:s=>{}},{label:"Complete",action:s=>{}}];return e.jsx(T,{title:"Housekeeping Supervisor Dashboard",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(l,{title:"Total Staff",value:r.length,icon:e.jsx(B,{}),iconColor:"text-blue-500"}),e.jsx(l,{title:"Online Staff",value:c.length,icon:e.jsx(m,{}),iconColor:"text-green-500",trend:{value:c.length>0?c.length/r.length*100:0,label:"on duty",isPositive:!0}}),e.jsx(l,{title:"Pending Tasks",value:h.length,icon:e.jsx(f,{}),iconColor:"text-orange-500"}),e.jsx(l,{title:"Completed Today",value:x.filter(s=>{const t=new Date().toDateString();return new Date(s.updatedAt||s.createdAt).toDateString()===t}).length,icon:e.jsx(w,{}),iconColor:"text-purple-500"})]}),e.jsxs(N,{children:[e.jsx(S,{children:e.jsx(A,{children:"Housekeeping Operations"})}),e.jsx(D,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(i,{variant:"outline",className:"h-20 flex flex-col items-center justify-center gap-0.5 p-0 [&_svg]:size-6","data-testid":"button-add-staff",onClick:()=>a("/housekeeping-supervisor/staff-management"),children:[e.jsx(I,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Add Staff"})]}),e.jsxs(i,{variant:"outline",className:"h-20 flex flex-col items-center justify-center gap-0.5 p-0 [&_svg]:size-6","data-testid":"button-assign-tasks",onClick:()=>a("/housekeeping-supervisor/task-assignment"),children:[e.jsx(f,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Assign Tasks"})]}),e.jsxs(i,{variant:"outline",className:"h-20 flex flex-col items-center justify-center gap-0.5 p-0 [&_svg]:size-6","data-testid":"button-duty-roster",onClick:()=>a("/housekeeping-supervisor/duty-tracking"),children:[e.jsx(m,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Duty Roster"})]}),e.jsxs(i,{variant:"outline",className:"h-20 flex flex-col items-center justify-center gap-0.5 p-0 [&_svg]:size-6","data-testid":"button-maintenance",onClick:()=>a("/housekeeping-supervisor/maintenance-requests"),children:[e.jsx(L,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Maintenance"})]})]})})]}),e.jsx(p,{title:"Housekeeping Staff",data:r,columns:k,actions:v,onAdd:()=>a("/housekeeping-supervisor/staff-management"),addButtonLabel:"Add Staff Member",searchPlaceholder:"Search staff..."}),e.jsx(p,{title:"Task Management",data:o,columns:j,actions:y,onAdd:()=>a("/housekeeping-supervisor/task-assignment"),addButtonLabel:"Create Task",searchPlaceholder:"Search tasks..."})]})})}export{U as default};
